
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; pydae-bmapu</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo_bmapu.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">pydae-bmapu</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to pydae-bmapu
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../models.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../buses.html">
     Buses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lines.html">
     Lines
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../syns.html">
     SYNSs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../syns/milano4.html">
       Milano 4
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../avrs.html">
     AVRs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../avrs/sexs.html">
       SEXS equivalent
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../avrs/ntsst1.html">
       ST1 equivalent
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../avrs/ntsst4.html">
       ST4 equivalent
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../govs.html">
     GOVs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../govs/tgov1.html">
       TGOV1 equivalent
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../govs/ntsieeeg1.html">
       NTS IEEEG1 equivalent
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../psss.html">
     PSSs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../psss/ntspss2.html">
       PSS2 equivalent
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../vscs.html">
     VSCs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../vscs/vsc_pq.html">
       VSC in PQ mode
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../builder.html">
   Builder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ini.html">
   Initialization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulation.html">
   Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ssa.html">
   SSA
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../examples.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../smib/smib.html">
     SMIB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="k12p6.html">
     Kundur example 12.6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nts_base/nts_base.html">
     NTS base case
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/pydae/pydae-bmapu-doc/main?urlpath=tree/book/examples/k12p6/k12p6_pss_builder.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/pydae/pydae-bmapu-doc"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/pydae/pydae-bmapu-doc/issues/new?title=Issue%20on%20page%20%2Fexamples/k12p6/k12p6_pss_builder.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/examples/k12p6/k12p6_pss_builder.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="simple visible nav section-nav flex-column">
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><no title></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="simple visible nav section-nav flex-column">
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="kn">import</span> <span class="nn">pydae.buildfast</span> <span class="k">as</span> <span class="nn">db</span>
<span class="kn">import</span> <span class="nn">pydae.build_cffi</span> <span class="k">as</span> <span class="nn">dbc</span>

<span class="kn">from</span> <span class="nn">pydae.grid_bpu</span> <span class="kn">import</span> <span class="n">bpu</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;k12p6_pss.json&#39;</span>
<span class="n">bpu_obj</span> <span class="o">=</span> <span class="n">bpu</span><span class="p">(</span><span class="n">data_input</span><span class="o">=</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_list</span> <span class="o">=</span> <span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">]</span> 
<span class="n">h_dict</span> <span class="o">=</span> <span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;h_dict&#39;</span><span class="p">]</span>
<span class="n">f_list</span> <span class="o">=</span> <span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
<span class="n">x_list</span> <span class="o">=</span> <span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">params_dict</span> <span class="o">=</span> <span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;params_dict&#39;</span><span class="p">]</span>

<span class="n">sys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;k12p6_pss&#39;</span><span class="p">,</span>
       <span class="s1">&#39;params_dict&#39;</span><span class="p">:</span><span class="n">params_dict</span><span class="p">,</span>
       <span class="s1">&#39;f_list&#39;</span><span class="p">:</span><span class="n">f_list</span><span class="p">,</span>
       <span class="s1">&#39;g_list&#39;</span><span class="p">:</span><span class="n">g_list</span><span class="p">,</span>
       <span class="s1">&#39;x_list&#39;</span><span class="p">:</span><span class="n">x_list</span><span class="p">,</span>
       <span class="s1">&#39;y_ini_list&#39;</span><span class="p">:</span><span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;y_ini&#39;</span><span class="p">],</span>
       <span class="s1">&#39;y_run_list&#39;</span><span class="p">:</span><span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;y_run&#39;</span><span class="p">],</span>
       <span class="s1">&#39;u_run_dict&#39;</span><span class="p">:</span><span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;u_run_dict&#39;</span><span class="p">],</span>
       <span class="s1">&#39;u_ini_dict&#39;</span><span class="p">:</span><span class="n">bpu_obj</span><span class="o">.</span><span class="n">dae</span><span class="p">[</span><span class="s1">&#39;u_ini_dict&#39;</span><span class="p">],</span>
       <span class="s1">&#39;h_dict&#39;</span><span class="p">:</span><span class="n">h_dict</span><span class="p">}</span>

<span class="n">sys</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">sys2num</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_6132</span><span class="o">/</span><span class="mf">1807683111.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> 
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">19</span> <span class="n">db</span><span class="o">.</span><span class="n">sys2num</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> 

<span class="nn">~\anaconda3\lib\site-packages\pydae\buildfast.py</span> in <span class="ni">sys2num</span><span class="nt">(sys, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">740</span>     <span class="n">matrix_name</span> <span class="o">=</span> <span class="s1">&#39;jac_run&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">741</span>     <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;y_run&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;u_run&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;params_dict&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">742</span>     <span class="n">jac_ss_eval</span> <span class="o">=</span> <span class="n">matrix2string</span><span class="p">(</span><span class="n">jac_run</span><span class="p">,</span><span class="n">function_header</span><span class="p">,</span><span class="n">matrix_name</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">743</span> 
<span class="g g-Whitespace">    </span><span class="mi">744</span> 

<span class="nn">~\anaconda3\lib\site-packages\pydae\buildfast.py</span> in <span class="ni">matrix2string</span><span class="nt">(matrix, function_header, matrix_name, x, y, u, p)</span>
<span class="g g-Whitespace">    </span><span class="mi">419</span>                 <span class="n">str_element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">420</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">421</span>                 <span class="n">str_element</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="n">element</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">422</span> 
<span class="g g-Whitespace">    </span><span class="mi">423</span>             <span class="k">if</span> <span class="n">str_element</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>

<span class="nn">~\anaconda3\lib\site-packages\pydae\buildfast.py</span> in <span class="ni">sym2str</span><span class="nt">(sym_exp, x, y, u, p, multi_eval)</span>
<span class="g g-Whitespace">    </span><span class="mi">350</span> <span class="k">def</span> <span class="nf">sym2str</span><span class="p">(</span><span class="n">sym_exp</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">multi_eval</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">351</span> 
<span class="ne">--&gt; </span><span class="mi">352</span>     <span class="n">matrix_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sym_exp</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span> 
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="n">mev</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\core\_print_helpers.py</span> in <span class="ni">__str__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span>     <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span>         <span class="kn">from</span> <span class="nn">sympy.printing.str</span> <span class="kn">import</span> <span class="n">sstr</span>
<span class="ne">---&gt; </span><span class="mi">29</span>         <span class="k">return</span> <span class="n">sstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> 
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span> 
<span class="g g-Whitespace">    </span><span class="mi">371</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">372</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wrapped__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span> 
<span class="g g-Whitespace">    </span><span class="mi">374</span>     <span class="nd">@property</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">sstr</span><span class="nt">(expr, **settings)</span>
<span class="g g-Whitespace">    </span><span class="mi">999</span> 
<span class="g g-Whitespace">   </span><span class="mi">1000</span>     <span class="n">p</span> <span class="o">=</span> <span class="n">StrPrinter</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1001</span>     <span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1002</span> 
<span class="g g-Whitespace">   </span><span class="mi">1003</span>     <span class="k">return</span> <span class="n">s</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">doprint</span><span class="nt">(self, expr)</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>     <span class="k">def</span> <span class="nf">doprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>         <span class="sd">&quot;&quot;&quot;Returns printer&#39;s representation for expr (as a string)&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">292</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">293</span> 
<span class="g g-Whitespace">    </span><span class="mi">294</span>     <span class="k">def</span> <span class="nf">_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">_print</span><span class="nt">(self, expr, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>                 <span class="n">printmethod</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printmethodname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>                 <span class="k">if</span> <span class="n">printmethod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">331</span>                     <span class="k">return</span> <span class="n">printmethod</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>             <span class="c1"># Unknown object, fall back to the emptyPrinter.</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptyPrinter</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">_print_Add</span><span class="nt">(self, expr, order)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span>         <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>         <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">58</span>             <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>             <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span>                 <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">_print</span><span class="nt">(self, expr, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>                 <span class="n">printmethod</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printmethodname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>                 <span class="k">if</span> <span class="n">printmethod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">331</span>                     <span class="k">return</span> <span class="n">printmethod</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>             <span class="c1"># Unknown object, fall back to the emptyPrinter.</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptyPrinter</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">_print_Mul</span><span class="nt">(self, expr)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>         <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="ow">or</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">367</span> 
<span class="ne">--&gt; </span><span class="mi">368</span>         <span class="n">a_str</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>         <span class="n">b_str</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span> 

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>         <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="ow">or</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">367</span> 
<span class="ne">--&gt; </span><span class="mi">368</span>         <span class="n">a_str</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>         <span class="n">b_str</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span> 

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">parenthesize</span><span class="nt">(self, item, level, strict)</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>             <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">39</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">_print</span><span class="nt">(self, expr, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>                 <span class="n">printmethod</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printmethodname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>                 <span class="k">if</span> <span class="n">printmethod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">331</span>                     <span class="k">return</span> <span class="n">printmethod</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>             <span class="c1"># Unknown object, fall back to the emptyPrinter.</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptyPrinter</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">_print_Function</span><span class="nt">(self, expr)</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span> 
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="k">def</span> <span class="nf">_print_Function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">162</span>         <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> 
<span class="g g-Whitespace">    </span><span class="mi">164</span>     <span class="k">def</span> <span class="nf">_print_GoldenRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">stringify</span><span class="nt">(self, args, sep, level)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">42</span>         <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> 
<span class="g g-Whitespace">     </span><span class="mi">44</span>     <span class="k">def</span> <span class="nf">emptyPrinter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">42</span>         <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> 
<span class="g g-Whitespace">     </span><span class="mi">44</span>     <span class="k">def</span> <span class="nf">emptyPrinter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">parenthesize</span><span class="nt">(self, item, level, strict)</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>             <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">39</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">_print</span><span class="nt">(self, expr, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>                 <span class="n">printmethod</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printmethodname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>                 <span class="k">if</span> <span class="n">printmethod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">331</span>                     <span class="k">return</span> <span class="n">printmethod</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>             <span class="c1"># Unknown object, fall back to the emptyPrinter.</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">emptyPrinter</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\str.py</span> in <span class="ni">_print_Add</span><span class="nt">(self, expr, order)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> 
<span class="g g-Whitespace">     </span><span class="mi">52</span>     <span class="k">def</span> <span class="nf">_print_Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">53</span>         <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_ordered_terms</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> 
<span class="g g-Whitespace">     </span><span class="mi">55</span>         <span class="n">PREC</span> <span class="o">=</span> <span class="n">precedence</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\sympy\printing\printer.py</span> in <span class="ni">_as_ordered_terms</span><span class="nt">(self, expr, order)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span>             <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">348</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">349</span>             <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">as_ordered_terms</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">350</span> 
<span class="g g-Whitespace">    </span><span class="mi">351</span> 

<span class="nn">~\anaconda3\lib\site-packages\sympy\core\expr.py</span> in <span class="ni">as_ordered_terms</span><span class="nt">(self, order, data)</span>
<span class="g g-Whitespace">   </span><span class="mi">1161</span> 
<span class="g g-Whitespace">   </span><span class="mi">1162</span>         <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">is_Order</span> <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1163</span>             <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1164</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1165</span>             <span class="n">_terms</span><span class="p">,</span> <span class="n">_order</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sysc</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">dbc</span><span class="o">.</span><span class="n">jacobians</span><span class="p">(</span><span class="n">sysc</span><span class="p">)</span>
<span class="n">defs</span><span class="p">,</span><span class="n">source</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">sym2src</span><span class="p">(</span><span class="n">sysc</span><span class="p">)</span>
<span class="n">dbc</span><span class="o">.</span><span class="n">compile_module</span><span class="p">(</span><span class="s1">&#39;k12p6_pss_c_cffi&#39;</span><span class="p">,</span><span class="n">defs</span><span class="p">,</span><span class="n">source</span><span class="p">)</span>
<span class="n">dbc</span><span class="o">.</span><span class="n">sys2num</span><span class="p">(</span><span class="s1">&#39;k12p6_pss_c&#39;</span><span class="p">,</span><span class="n">sysc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.1689989566802979
1.2241497039794922
Compilation time: 4.71 s
sys2num (time: 0.005035877227783203)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.matrices.sparsetools</span> <span class="kn">import</span> <span class="n">_doktocsr</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">SparseMatrix</span>

<span class="n">Fx_ini</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Fx_ini&#39;</span><span class="p">]</span>
<span class="n">Fy_ini</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Fy_ini&#39;</span><span class="p">]</span>
<span class="n">Gx_ini</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Gx_ini&#39;</span><span class="p">]</span>
<span class="n">Gy_ini</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Gy_ini&#39;</span><span class="p">]</span>

<span class="n">Fx_run</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Fx_run&#39;</span><span class="p">]</span>
<span class="n">Fy_run</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Fy_run&#39;</span><span class="p">]</span>
<span class="n">Gx_run</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Gx_run&#39;</span><span class="p">]</span>
<span class="n">Gy_run</span> <span class="o">=</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;Gy_run&#39;</span><span class="p">]</span>

<span class="n">jac_ini</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">Fx_ini</span><span class="p">,</span> <span class="n">Fy_ini</span><span class="p">],[</span><span class="n">Gx_ini</span><span class="p">,</span><span class="n">Gy_ini</span><span class="p">]])</span>  
<span class="n">sp_jac_ini_list</span> <span class="o">=</span> <span class="n">_doktocsr</span><span class="p">(</span><span class="n">SparseMatrix</span><span class="p">(</span><span class="n">jac_ini</span><span class="p">))</span>


<span class="n">N_x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
<span class="n">eye</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N_x</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Dt</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;Dt&#39;</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">jac_trap</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">eye</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Dt</span><span class="o">*</span><span class="n">Fx_run</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">Dt</span><span class="o">*</span><span class="n">Fy_run</span><span class="p">],[</span><span class="n">Gx_run</span><span class="p">,</span><span class="n">Gy_run</span><span class="p">]])</span>  
<span class="n">sp_jac_trap_list</span> <span class="o">=</span> <span class="n">_doktocsr</span><span class="p">(</span><span class="n">SparseMatrix</span><span class="p">(</span><span class="n">jac_trap</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">sympy.codegen.ast</span> <span class="kn">import</span> <span class="n">Assignment</span>
<span class="n">LHS</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">)</span>
<span class="c1">#init_printing(use_unicode=True)</span>

<span class="n">matrix_name</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">jac_trap</span>
<span class="n">string_sym</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_xy</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_up</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string_sym</span> <span class="o">+=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">Assignment</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span><span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">N</span><span class="o">*</span><span class="n">irow</span><span class="o">+</span><span class="n">icol</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            
<span class="n">string</span> <span class="o">=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9993274211883545
out[0] = 0.5*Dt*p[53] + 1;
out[1] = -0.5*Dt*p[43];
out[103] = 0.5*Dt*p[43];
out[105] = -0.25*Dt*(-y[0]*y[22]*cos(x[0] - y[1]) + y[0]*y[23]*sin(x[0] - y[1]))/p[44];
out[106] = 0.25*p[51]*Dt/p[44] + 1;
out[150] = -0.25*Dt*(-y[22]*sin(x[0] - y[1]) - y[23]*cos(x[0] - y[1]))/p[44];
out[151] = -0.25*Dt*(y[0]*y[22]*cos(x[0] - y[1]) - y[0]*y[23]*sin(x[0] - y[1]))/p[44];
out[172] = -0.25*Dt*(-2*p[52]*y[22] - y[0]*sin(x[0] - y[1]))/p[44];
out[173] = -0.25*Dt*(-2*p[52]*y[23] - y[0]*cos(x[0] - y[1]))/p[44];
out[178] = -0.25*Dt/p[44];
out[208] = -0.25*p[51]*Dt/p[44];
out[212] = 0.5*Dt/p[45] + 1;
out[277] = -0.5*Dt*(p[49] - p[47])/p[45];
out[281] = -0.5*Dt/p[45];
out[318] = 0.5*Dt/p[46] + 1;
out[383] = -0.5*Dt*(-p[50] + p[48])/p[46];
out[424] = 0.5*Dt/p[57] + 1;
out[465] = -0.5*Dt/p[57];
out[529] = -0.5*Dt*(p[55]*p[60] - 1);
out[530] = 0.5*Dt*p[56]*p[60] + 1;
out[596] = -0.5*Dt*p[60];
out[600] = -0.5*Dt*(-p[55]*p[60] + 1);
out[636] = 0.5*Dt/p[62] + 1;
out[702] = -0.5*Dt/p[62];
out[741] = -0.5*Dt/p[64];
out[742] = 0.5*Dt/p[64] + 1;
out[848] = 4.9999999999999998e-7*Dt + 1;
out[909] = 0.5*Dt*p[65];
out[946] = -0.5*Dt/p[67];
out[954] = 0.5*Dt/p[67] + 1;
out[1060] = 0.5*Dt/p[69] + 1;
out[1124] = -0.5*Dt/p[69];
out[1166] = 0.5*Dt*p[83] + 1;
out[1167] = -0.5*Dt*p[73];
out[1258] = 0.5*Dt*p[73];
out[1271] = -0.25*Dt*(-y[2]*y[31]*cos(x[11] - y[3]) + y[2]*y[32]*sin(x[11] - y[3]))/p[74];
out[1272] = 0.25*p[81]*Dt/p[74] + 1;
out[1307] = -0.25*Dt*(-y[31]*sin(x[11] - y[3]) - y[32]*cos(x[11] - y[3]))/p[74];
out[1308] = -0.25*Dt*(y[2]*y[31]*cos(x[11] - y[3]) - y[2]*y[32]*sin(x[11] - y[3]))/p[74];
out[1336] = -0.25*Dt*(-2*p[82]*y[31] - y[2]*sin(x[11] - y[3]))/p[74];
out[1337] = -0.25*Dt*(-2*p[82]*y[32] - y[2]*cos(x[11] - y[3]))/p[74];
out[1342] = -0.25*Dt/p[74];
out[1363] = -0.25*p[81]*Dt/p[74];
out[1378] = 0.5*Dt/p[75] + 1;
out[1441] = -0.5*Dt*(p[79] - p[77])/p[75];
out[1445] = -0.5*Dt/p[75];
out[1484] = 0.5*Dt/p[76] + 1;
out[1547] = -0.5*Dt*(-p[80] + p[78])/p[76];
out[1590] = 0.5*Dt/p[87] + 1;
out[1622] = -0.5*Dt/p[87];
out[1695] = -0.5*Dt*(p[85]*p[90] - 1);
out[1696] = 0.5*Dt*p[86]*p[90] + 1;
out[1760] = -0.5*Dt*p[90];
out[1764] = -0.5*Dt*(-p[85]*p[90] + 1);
out[1802] = 0.5*Dt/p[92] + 1;
out[1866] = -0.5*Dt/p[92];
out[1907] = -0.5*Dt/p[94];
out[1908] = 0.5*Dt/p[94] + 1;
out[2014] = 4.9999999999999998e-7*Dt + 1;
out[2073] = 0.5*Dt*p[95];
out[2112] = -0.5*Dt/p[97];
out[2120] = 0.5*Dt/p[97] + 1;
out[2226] = 0.5*Dt/p[99] + 1;
out[2288] = -0.5*Dt/p[99];
out[2332] = 0.5*Dt*p[113] + 1;
out[2333] = -0.5*Dt*p[103];
out[2413] = 0.5*Dt*p[103];
out[2437] = -0.25*Dt*(-y[4]*y[40]*cos(x[22] - y[5]) + y[4]*y[41]*sin(x[22] - y[5]))/p[104];
out[2438] = 0.25*p[111]*Dt/p[104] + 1;
out[2464] = -0.25*Dt*(-y[40]*sin(x[22] - y[5]) - y[41]*cos(x[22] - y[5]))/p[104];
out[2465] = -0.25*Dt*(y[4]*y[40]*cos(x[22] - y[5]) - y[4]*y[41]*sin(x[22] - y[5]))/p[104];
out[2500] = -0.25*Dt*(-2*p[112]*y[40] - y[4]*sin(x[22] - y[5]))/p[104];
out[2501] = -0.25*Dt*(-2*p[112]*y[41] - y[4]*cos(x[22] - y[5]))/p[104];
out[2506] = -0.25*Dt/p[104];
out[2518] = -0.25*p[111]*Dt/p[104];
out[2544] = 0.5*Dt/p[105] + 1;
out[2605] = -0.5*Dt*(p[109] - p[107])/p[105];
out[2609] = -0.5*Dt/p[105];
out[2650] = 0.5*Dt/p[106] + 1;
out[2711] = -0.5*Dt*(-p[110] + p[108])/p[106];
out[2756] = 0.5*Dt/p[117] + 1;
out[2779] = -0.5*Dt/p[117];
out[2861] = -0.5*Dt*(p[115]*p[120] - 1);
out[2862] = 0.5*Dt*p[116]*p[120] + 1;
out[2924] = -0.5*Dt*p[120];
out[2928] = -0.5*Dt*(-p[115]*p[120] + 1);
out[2968] = 0.5*Dt/p[122] + 1;
out[3030] = -0.5*Dt/p[122];
out[3073] = -0.5*Dt/p[124];
out[3074] = 0.5*Dt/p[124] + 1;
out[3180] = 4.9999999999999998e-7*Dt + 1;
out[3237] = 0.5*Dt*p[125];
out[3278] = -0.5*Dt/p[127];
out[3286] = 0.5*Dt/p[127] + 1;
out[3392] = 0.5*Dt/p[129] + 1;
out[3452] = -0.5*Dt/p[129];
out[3498] = 0.5*Dt*p[143] + 1;
out[3499] = -0.5*Dt*p[133];
out[3568] = 0.5*Dt*p[133];
out[3603] = -0.25*Dt*(-y[6]*y[49]*cos(x[33] - y[7]) + y[6]*y[50]*sin(x[33] - y[7]))/p[134];
out[3604] = 0.25*p[141]*Dt/p[134] + 1;
out[3621] = -0.25*Dt*(-y[49]*sin(x[33] - y[7]) - y[50]*cos(x[33] - y[7]))/p[134];
out[3622] = -0.25*Dt*(y[6]*y[49]*cos(x[33] - y[7]) - y[6]*y[50]*sin(x[33] - y[7]))/p[134];
out[3664] = -0.25*Dt*(-2*p[142]*y[49] - y[6]*sin(x[33] - y[7]))/p[134];
out[3665] = -0.25*Dt*(-2*p[142]*y[50] - y[6]*cos(x[33] - y[7]))/p[134];
out[3670] = -0.25*Dt/p[134];
out[3673] = -0.25*p[141]*Dt/p[134];
out[3710] = 0.5*Dt/p[135] + 1;
out[3769] = -0.5*Dt*(p[139] - p[137])/p[135];
out[3773] = -0.5*Dt/p[135];
out[3816] = 0.5*Dt/p[136] + 1;
out[3875] = -0.5*Dt*(-p[140] + p[138])/p[136];
out[3922] = 0.5*Dt/p[147] + 1;
out[3936] = -0.5*Dt/p[147];
out[4027] = -0.5*Dt*(p[145]*p[150] - 1);
out[4028] = 0.5*Dt*p[146]*p[150] + 1;
out[4088] = -0.5*Dt*p[150];
out[4092] = -0.5*Dt*(-p[145]*p[150] + 1);
out[4134] = 0.5*Dt/p[152] + 1;
out[4194] = -0.5*Dt/p[152];
out[4239] = -0.5*Dt/p[154];
out[4240] = 0.5*Dt/p[154] + 1;
out[4346] = 4.9999999999999998e-7*Dt + 1;
out[4401] = 0.5*Dt*p[155];
out[4444] = -0.5*Dt/p[157];
out[4452] = 0.5*Dt/p[157] + 1;
out[4558] = 0.5*Dt/p[159] + 1;
out[4616] = -0.5*Dt/p[159];
out[4664] = 1;
out[4723] = 0.5*Dt;
out[4770] = 2*y[0]*p[1] + y[8]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4771] = y[0]*y[8]*(-p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[4778] = y[0]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4779] = y[0]*y[8]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4794] = -p[42]/p[0];
out[4875] = 2*y[0]*(-p[2] - 1.0/2.0*p[3]) + y[8]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4876] = y[0]*y[8]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4883] = y[0]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4884] = y[0]*y[8]*(p[2]*sin(y[1] - y[9]) + p[1]*cos(y[1] - y[9]));
out[4900] = -p[42]/p[0];
out[4982] = 2*y[2]*p[4] + y[10]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[4983] = y[2]*y[10]*(-p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[4990] = y[2]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[4991] = y[2]*y[10]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5013] = -p[72]/p[0];
out[5087] = 2*y[2]*(-p[5] - 1.0/2.0*p[6]) + y[10]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5088] = y[2]*y[10]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[5095] = y[2]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5096] = y[2]*y[10]*(p[5]*sin(y[3] - y[11]) + p[4]*cos(y[3] - y[11]));
out[5119] = -p[72]/p[0];
out[5194] = y[20]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5])) + 2*y[4]*p[7];
out[5195] = y[20]*y[4]*(-p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[5210] = y[4]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[5211] = y[20]*y[4]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[5232] = -p[102]/p[0];
out[5299] = y[20]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5])) + 2*y[4]*(-p[8] - 1.0/2.0*p[9]);
out[5300] = y[20]*y[4]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[5315] = y[4]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[5316] = y[20]*y[4]*(-p[8]*sin(y[21] - y[5]) + p[7]*cos(y[21] - y[5]));
out[5338] = -p[102]/p[0];
out[5406] = y[18]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + 2*y[6]*p[10];
out[5407] = y[18]*y[6]*(-p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[5418] = y[6]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[5419] = y[18]*y[6]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7]));
out[5451] = -p[132]/p[0];
out[5511] = y[18]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7])) + 2*y[6]*(-p[11] - 1.0/2.0*p[12]);
out[5512] = y[18]*y[6]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[5523] = y[6]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7]));
out[5524] = y[18]*y[6]*(-p[11]*sin(y[19] - y[7]) + p[10]*cos(y[19] - y[7]));
out[5557] = -p[132]/p[0];
out[5610] = y[8]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[5611] = y[0]*y[8]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[5618] = y[0]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9])) + 2*y[8]*(p[1] + p[13]) + y[10]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5619] = y[0]*y[8]*(-p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9])) + y[8]*y[10]*(-p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5620] = y[8]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5621] = y[8]*y[10]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5715] = y[8]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[5716] = y[0]*y[8]*(-p[2]*sin(y[1] - y[9]) + p[1]*cos(y[1] - y[9]));
out[5723] = y[0]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9])) + 2*y[8]*(-p[2] - p[14] - 1.0/2.0*p[3] - 1.0/2.0*p[15]) + y[10]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5724] = y[0]*y[8]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9])) + y[8]*y[10]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5725] = y[8]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5726] = y[8]*y[10]*(p[14]*sin(y[9] - y[11]) + p[13]*cos(y[9] - y[11]));
out[5822] = y[10]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[5823] = y[2]*y[10]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[5828] = y[10]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5829] = y[8]*y[10]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5830] = y[2]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11])) + y[8]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11])) + 2*y[10]*(p[4] + p[13] + p[16]) + y[12]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5831] = y[2]*y[10]*(-p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11])) + y[8]*y[10]*(-p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11])) + y[10]*y[12]*(-p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[5832] = y[10]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5833] = y[10]*y[12]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5927] = y[10]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[5928] = y[2]*y[10]*(-p[5]*sin(y[3] - y[11]) + p[4]*cos(y[3] - y[11]));
out[5933] = y[10]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5934] = y[8]*y[10]*(-p[14]*sin(y[9] - y[11]) + p[13]*cos(y[9] - y[11]));
out[5935] = y[2]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11])) + y[8]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11])) + 2*y[10]*(-p[5] - p[14] - p[17] - 1.0/2.0*p[6] - 1.0/2.0*p[15] - 1.0/2.0*p[18]) + y[12]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5936] = y[2]*y[10]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11])) + y[8]*y[10]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11])) + y[10]*y[12]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5937] = y[10]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5938] = y[10]*y[12]*(p[17]*sin(y[11] - y[13]) + p[16]*cos(y[11] - y[13]));
out[6040] = y[12]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[6041] = y[10]*y[12]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[6042] = y[10]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13])) + 2*y[12]*(p[16] + 2*p[19]) + y[14]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6043] = y[10]*y[12]*(-p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13])) + y[12]*y[14]*(-2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6044] = y[12]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6045] = y[12]*y[14]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6145] = y[12]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[6146] = y[10]*y[12]*(-p[17]*sin(y[11] - y[13]) + p[16]*cos(y[11] - y[13]));
out[6147] = y[10]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13])) + 2*y[12]*(-p[17] - 2*p[20] - 1.0/2.0*p[18] - p[21]) + y[14]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6148] = y[10]*y[12]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13])) + y[12]*y[14]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6149] = y[12]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6150] = y[12]*y[14]*(2*p[20]*sin(y[13] - y[15]) + 2*p[19]*cos(y[13] - y[15]));
out[6252] = y[14]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6253] = y[12]*y[14]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6254] = y[12]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15])) + 2*y[14]*(2*p[19] + 2*p[22]) + y[16]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6255] = y[12]*y[14]*(-2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15])) + y[14]*y[16]*(-2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6256] = y[14]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6257] = y[14]*y[16]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6357] = y[14]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6358] = y[12]*y[14]*(-2*p[20]*sin(y[13] - y[15]) + 2*p[19]*cos(y[13] - y[15]));
out[6359] = y[12]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15])) + 2*y[14]*(-2*p[20] - 2*p[23] - p[21] - p[24]) + y[16]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6360] = y[12]*y[14]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15])) + y[14]*y[16]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6361] = y[14]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6362] = y[14]*y[16]*(2*p[23]*sin(y[15] - y[17]) + 2*p[22]*cos(y[15] - y[17]));
out[6464] = y[16]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6465] = y[14]*y[16]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6466] = y[18]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17])) + y[14]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17])) + 2*y[16]*(2*p[22] + p[25]);
out[6467] = y[18]*y[16]*(-p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17])) + y[14]*y[16]*(-2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6468] = y[16]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6469] = y[18]*y[16]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6569] = y[16]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6570] = y[14]*y[16]*(-2*p[23]*sin(y[15] - y[17]) + 2*p[22]*cos(y[15] - y[17]));
out[6571] = y[18]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17])) + y[14]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17])) + 2*y[16]*(-2*p[23] - p[26] - p[24] - 1.0/2.0*p[27]);
out[6572] = y[18]*y[16]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17])) + y[14]*y[16]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6573] = y[16]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6574] = y[18]*y[16]*(-p[26]*sin(y[19] - y[17]) + p[25]*cos(y[19] - y[17]));
out[6666] = y[18]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[6667] = y[18]*y[6]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[6676] = y[18]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6677] = y[18]*y[16]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6678] = 2*y[18]*(p[28] + p[10] + p[25]) + y[20]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[6]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + y[16]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6679] = y[18]*y[20]*(-p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21])) + y[18]*y[6]*(-p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7])) + y[18]*y[16]*(-p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6680] = y[18]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21]));
out[6681] = y[18]*y[20]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21]));
out[6771] = y[18]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[6772] = y[18]*y[6]*(p[11]*sin(y[19] - y[7]) + p[10]*cos(y[19] - y[7]));
out[6781] = y[18]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6782] = y[18]*y[16]*(p[26]*sin(y[19] - y[17]) + p[25]*cos(y[19] - y[17]));
out[6783] = 2*y[18]*(-p[29] - p[11] - p[26] - 1.0/2.0*p[30] - 1.0/2.0*p[12] - 1.0/2.0*p[27]) + y[20]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21])) + y[6]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7])) + y[16]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6784] = y[18]*y[20]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[18]*y[6]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + y[18]*y[16]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6785] = y[18]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21]));
out[6786] = y[18]*y[20]*(p[29]*sin(y[19] - y[21]) + p[28]*cos(y[19] - y[21]));
out[6874] = y[20]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[6875] = y[20]*y[4]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6888] = y[20]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21]));
out[6889] = y[18]*y[20]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21]));
out[6890] = y[18]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + 2*y[20]*(p[28] + p[7]) + y[4]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[6891] = y[18]*y[20]*(-p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21])) + y[20]*y[4]*(-p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[6979] = y[20]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6980] = y[20]*y[4]*(p[8]*sin(y[21] - y[5]) + p[7]*cos(y[21] - y[5]));
out[6993] = y[20]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21]));
out[6994] = y[18]*y[20]*(-p[29]*sin(y[19] - y[21]) + p[28]*cos(y[19] - y[21]));
out[6995] = y[18]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21])) + 2*y[20]*(-p[29] - p[8] - 1.0/2.0*p[30] - 1.0/2.0*p[9]) + y[4]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6996] = y[18]*y[20]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[20]*y[4]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[7035] = -y[0]*sin(x[0] - y[1]);
out[7037] = -1;
out[7080] = cos(x[0] - y[1]);
out[7081] = y[0]*sin(x[0] - y[1]);
out[7102] = p[49];
out[7103] = p[52];
out[7140] = y[0]*cos(x[0] - y[1]);
out[7143] = -1;
out[7185] = sin(x[0] - y[1]);
out[7186] = -y[0]*cos(x[0] - y[1]);
out[7207] = p[52];
out[7208] = -p[50];
out[7245] = y[0]*y[22]*cos(x[0] - y[1]) - y[0]*y[23]*sin(x[0] - y[1]);
out[7290] = y[22]*sin(x[0] - y[1]) + y[23]*cos(x[0] - y[1]);
out[7291] = -y[0]*y[22]*cos(x[0] - y[1]) + y[0]*y[23]*sin(x[0] - y[1]);
out[7312] = y[0]*sin(x[0] - y[1]);
out[7313] = y[0]*cos(x[0] - y[1]);
out[7314] = -1;
out[7350] = -y[0]*y[22]*sin(x[0] - y[1]) - y[0]*y[23]*cos(x[0] - y[1]);
out[7395] = y[22]*cos(x[0] - y[1]) - y[23]*sin(x[0] - y[1]);
out[7396] = y[0]*y[22]*sin(x[0] - y[1]) + y[0]*y[23]*cos(x[0] - y[1]);
out[7417] = y[0]*cos(x[0] - y[1]);
out[7418] = -y[0]*sin(x[0] - y[1]);
out[7420] = -1;
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7459] = 0;
}
else {
   out[7459] = -p[55];
}
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7460] = 0;
}
else {
   out[7460] = p[56];
}
out[7526] = -1;
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7530] = 0;
}
else {
   out[7530] = p[55];
}
out[7561] = -1/p[61];
out[7568] = 1;
out[7632] = -1;
out[7664] = p[54];
out[7671] = p[63]/p[64];
out[7672] = -p[63]/p[64] + 1;
out[7738] = -1;
out[7771] = 1;
out[7779] = -1;
out[7844] = -1;
if (p[71] &lt; -p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10]) || p[71] &lt; p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10])) {
   out[7885] = 0;
}
else {
   out[7885] = p[70]*(-p[68]/p[69] + 1);
}
if (p[71] &lt; -p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10]) || p[71] &lt; p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10])) {
   out[7949] = 0;
}
else {
   out[7949] = p[70]*p[68]/p[69];
}
out[7950] = -1;
out[7991] = -y[2]*sin(x[11] - y[3]);
out[7993] = -1;
out[8027] = cos(x[11] - y[3]);
out[8028] = y[2]*sin(x[11] - y[3]);
out[8056] = p[79];
out[8057] = p[82];
out[8096] = y[2]*cos(x[11] - y[3]);
out[8099] = -1;
out[8132] = sin(x[11] - y[3]);
out[8133] = -y[2]*cos(x[11] - y[3]);
out[8161] = p[82];
out[8162] = -p[80];
out[8201] = y[2]*y[31]*cos(x[11] - y[3]) - y[2]*y[32]*sin(x[11] - y[3]);
out[8237] = y[31]*sin(x[11] - y[3]) + y[32]*cos(x[11] - y[3]);
out[8238] = -y[2]*y[31]*cos(x[11] - y[3]) + y[2]*y[32]*sin(x[11] - y[3]);
out[8266] = y[2]*sin(x[11] - y[3]);
out[8267] = y[2]*cos(x[11] - y[3]);
out[8268] = -1;
out[8306] = -y[2]*y[31]*sin(x[11] - y[3]) - y[2]*y[32]*cos(x[11] - y[3]);
out[8342] = y[31]*cos(x[11] - y[3]) - y[32]*sin(x[11] - y[3]);
out[8343] = y[2]*y[31]*sin(x[11] - y[3]) + y[2]*y[32]*cos(x[11] - y[3]);
out[8371] = y[2]*cos(x[11] - y[3]);
out[8372] = -y[2]*sin(x[11] - y[3]);
out[8374] = -1;
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8415] = 0;
}
else {
   out[8415] = -p[85];
}
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8416] = 0;
}
else {
   out[8416] = p[86];
}
out[8480] = -1;
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8484] = 0;
}
else {
   out[8484] = p[85];
}
out[8517] = -1/p[91];
out[8524] = 1;
out[8586] = -1;
out[8609] = p[84];
out[8627] = p[93]/p[94];
out[8628] = -p[93]/p[94] + 1;
out[8692] = -1;
out[8727] = 1;
out[8735] = -1;
out[8798] = -1;
if (p[101] &lt; -p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21]) || p[101] &lt; p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21])) {
   out[8841] = 0;
}
else {
   out[8841] = p[100]*(-p[98]/p[99] + 1);
}
if (p[101] &lt; -p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21]) || p[101] &lt; p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21])) {
   out[8903] = 0;
}
else {
   out[8903] = p[100]*p[98]/p[99];
}
out[8904] = -1;
out[8947] = -y[4]*sin(x[22] - y[5]);
out[8949] = -1;
out[8974] = cos(x[22] - y[5]);
out[8975] = y[4]*sin(x[22] - y[5]);
out[9010] = p[109];
out[9011] = p[112];
out[9052] = y[4]*cos(x[22] - y[5]);
out[9055] = -1;
out[9079] = sin(x[22] - y[5]);
out[9080] = -y[4]*cos(x[22] - y[5]);
out[9115] = p[112];
out[9116] = -p[110];
out[9157] = y[4]*y[40]*cos(x[22] - y[5]) - y[4]*y[41]*sin(x[22] - y[5]);
out[9184] = y[40]*sin(x[22] - y[5]) + y[41]*cos(x[22] - y[5]);
out[9185] = -y[4]*y[40]*cos(x[22] - y[5]) + y[4]*y[41]*sin(x[22] - y[5]);
out[9220] = y[4]*sin(x[22] - y[5]);
out[9221] = y[4]*cos(x[22] - y[5]);
out[9222] = -1;
out[9262] = -y[4]*y[40]*sin(x[22] - y[5]) - y[4]*y[41]*cos(x[22] - y[5]);
out[9289] = y[40]*cos(x[22] - y[5]) - y[41]*sin(x[22] - y[5]);
out[9290] = y[4]*y[40]*sin(x[22] - y[5]) + y[4]*y[41]*cos(x[22] - y[5]);
out[9325] = y[4]*cos(x[22] - y[5]);
out[9326] = -y[4]*sin(x[22] - y[5]);
out[9328] = -1;
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9371] = 0;
}
else {
   out[9371] = -p[115];
}
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9372] = 0;
}
else {
   out[9372] = p[116];
}
out[9434] = -1;
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9438] = 0;
}
else {
   out[9438] = p[115];
}
out[9473] = -1/p[121];
out[9480] = 1;
out[9540] = -1;
out[9554] = p[114];
out[9583] = p[123]/p[124];
out[9584] = -p[123]/p[124] + 1;
out[9646] = -1;
out[9683] = 1;
out[9691] = -1;
out[9752] = -1;
if (p[131] &lt; -p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32]) || p[131] &lt; p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32])) {
   out[9797] = 0;
}
else {
   out[9797] = p[130]*(-p[128]/p[129] + 1);
}
if (p[131] &lt; -p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32]) || p[131] &lt; p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32])) {
   out[9857] = 0;
}
else {
   out[9857] = p[130]*p[128]/p[129];
}
out[9858] = -1;
out[9903] = -y[6]*sin(x[33] - y[7]);
out[9905] = -1;
out[9921] = cos(x[33] - y[7]);
out[9922] = y[6]*sin(x[33] - y[7]);
out[9964] = p[139];
out[9965] = p[142];
out[10008] = y[6]*cos(x[33] - y[7]);
out[10011] = -1;
out[10026] = sin(x[33] - y[7]);
out[10027] = -y[6]*cos(x[33] - y[7]);
out[10069] = p[142];
out[10070] = -p[140];
out[10113] = y[6]*y[49]*cos(x[33] - y[7]) - y[6]*y[50]*sin(x[33] - y[7]);
out[10131] = y[49]*sin(x[33] - y[7]) + y[50]*cos(x[33] - y[7]);
out[10132] = -y[6]*y[49]*cos(x[33] - y[7]) + y[6]*y[50]*sin(x[33] - y[7]);
out[10174] = y[6]*sin(x[33] - y[7]);
out[10175] = y[6]*cos(x[33] - y[7]);
out[10176] = -1;
out[10218] = -y[6]*y[49]*sin(x[33] - y[7]) - y[6]*y[50]*cos(x[33] - y[7]);
out[10236] = y[49]*cos(x[33] - y[7]) - y[50]*sin(x[33] - y[7]);
out[10237] = y[6]*y[49]*sin(x[33] - y[7]) + y[6]*y[50]*cos(x[33] - y[7]);
out[10279] = y[6]*cos(x[33] - y[7]);
out[10280] = -y[6]*sin(x[33] - y[7]);
out[10282] = -1;
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10327] = 0;
}
else {
   out[10327] = -p[145];
}
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10328] = 0;
}
else {
   out[10328] = p[146];
}
out[10388] = -1;
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10392] = 0;
}
else {
   out[10392] = p[145];
}
out[10429] = -1/p[151];
out[10436] = 1;
out[10494] = -1;
out[10499] = p[144];
out[10539] = p[153]/p[154];
out[10540] = -p[153]/p[154] + 1;
out[10600] = -1;
out[10639] = 1;
out[10647] = -1;
out[10706] = -1;
if (p[161] &lt; -p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43]) || p[161] &lt; p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43])) {
   out[10753] = 0;
}
else {
   out[10753] = p[160]*(-p[158]/p[159] + 1);
}
if (p[161] &lt; -p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43]) || p[161] &lt; p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43])) {
   out[10811] = 0;
}
else {
   out[10811] = p[160]*p[158]/p[159];
}
out[10812] = -1;
out[10816] = p[44]*p[42]/(p[44]*p[42] + p[74]*p[72] + p[104]*p[102] + p[134]*p[132]);
out[10827] = p[74]*p[72]/(p[44]*p[42] + p[74]*p[72] + p[104]*p[102] + p[134]*p[132]);
out[10838] = p[104]*p[102]/(p[44]*p[42] + p[74]*p[72] + p[104]*p[102] + p[134]*p[132]);
out[10849] = p[134]*p[132]/(p[44]*p[42] + p[74]*p[72] + p[104]*p[102] + p[134]*p[132]);
out[10918] = -1;
out[10964] = p[163];
out[11023] = -p[162];
out[11024] = -1;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LHS</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">)</span>
<span class="c1">#init_printing(use_unicode=True)</span>

<span class="n">matrix_name</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">jac_trap</span>
<span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_xy</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_up</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">string_num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">Assignment</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span><span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">irow</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">icol</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">string_i</span> <span class="o">=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s1">&#39;x[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;y[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                <span class="n">string_xy</span> <span class="o">+=</span> <span class="n">string_i</span> 
            <span class="k">elif</span> <span class="s1">&#39;p[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;u[&#39;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s1">&#39;Dt&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                <span class="n">string_up</span> <span class="o">+=</span> <span class="n">string_i</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string_num</span> <span class="o">+=</span> <span class="n">string_i</span> 
    
            

<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">string_xy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1256356239318848
out[105] = -0.25*Dt*(-y[0]*y[22]*cos(x[0] - y[1]) + y[0]*y[23]*sin(x[0] - y[1]))/p[44];
out[150] = -0.25*Dt*(-y[22]*sin(x[0] - y[1]) - y[23]*cos(x[0] - y[1]))/p[44];
out[151] = -0.25*Dt*(y[0]*y[22]*cos(x[0] - y[1]) - y[0]*y[23]*sin(x[0] - y[1]))/p[44];
out[172] = -0.25*Dt*(-2*p[52]*y[22] - y[0]*sin(x[0] - y[1]))/p[44];
out[173] = -0.25*Dt*(-2*p[52]*y[23] - y[0]*cos(x[0] - y[1]))/p[44];
out[1271] = -0.25*Dt*(-y[2]*y[31]*cos(x[11] - y[3]) + y[2]*y[32]*sin(x[11] - y[3]))/p[74];
out[1307] = -0.25*Dt*(-y[31]*sin(x[11] - y[3]) - y[32]*cos(x[11] - y[3]))/p[74];
out[1308] = -0.25*Dt*(y[2]*y[31]*cos(x[11] - y[3]) - y[2]*y[32]*sin(x[11] - y[3]))/p[74];
out[1336] = -0.25*Dt*(-2*p[82]*y[31] - y[2]*sin(x[11] - y[3]))/p[74];
out[1337] = -0.25*Dt*(-2*p[82]*y[32] - y[2]*cos(x[11] - y[3]))/p[74];
out[2437] = -0.25*Dt*(-y[4]*y[40]*cos(x[22] - y[5]) + y[4]*y[41]*sin(x[22] - y[5]))/p[104];
out[2464] = -0.25*Dt*(-y[40]*sin(x[22] - y[5]) - y[41]*cos(x[22] - y[5]))/p[104];
out[2465] = -0.25*Dt*(y[4]*y[40]*cos(x[22] - y[5]) - y[4]*y[41]*sin(x[22] - y[5]))/p[104];
out[2500] = -0.25*Dt*(-2*p[112]*y[40] - y[4]*sin(x[22] - y[5]))/p[104];
out[2501] = -0.25*Dt*(-2*p[112]*y[41] - y[4]*cos(x[22] - y[5]))/p[104];
out[3603] = -0.25*Dt*(-y[6]*y[49]*cos(x[33] - y[7]) + y[6]*y[50]*sin(x[33] - y[7]))/p[134];
out[3621] = -0.25*Dt*(-y[49]*sin(x[33] - y[7]) - y[50]*cos(x[33] - y[7]))/p[134];
out[3622] = -0.25*Dt*(y[6]*y[49]*cos(x[33] - y[7]) - y[6]*y[50]*sin(x[33] - y[7]))/p[134];
out[3664] = -0.25*Dt*(-2*p[142]*y[49] - y[6]*sin(x[33] - y[7]))/p[134];
out[3665] = -0.25*Dt*(-2*p[142]*y[50] - y[6]*cos(x[33] - y[7]))/p[134];
out[4770] = 2*y[0]*p[1] + y[8]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4771] = y[0]*y[8]*(-p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[4778] = y[0]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4779] = y[0]*y[8]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4875] = 2*y[0]*(-p[2] - 1.0/2.0*p[3]) + y[8]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4876] = y[0]*y[8]*(-p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[4883] = y[0]*(p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9]));
out[4884] = y[0]*y[8]*(p[2]*sin(y[1] - y[9]) + p[1]*cos(y[1] - y[9]));
out[4982] = 2*y[2]*p[4] + y[10]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[4983] = y[2]*y[10]*(-p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[4990] = y[2]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[4991] = y[2]*y[10]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5087] = 2*y[2]*(-p[5] - 1.0/2.0*p[6]) + y[10]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5088] = y[2]*y[10]*(-p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[5095] = y[2]*(p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11]));
out[5096] = y[2]*y[10]*(p[5]*sin(y[3] - y[11]) + p[4]*cos(y[3] - y[11]));
out[5194] = y[20]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5])) + 2*y[4]*p[7];
out[5195] = y[20]*y[4]*(-p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[5210] = y[4]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[5211] = y[20]*y[4]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[5299] = y[20]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5])) + 2*y[4]*(-p[8] - 1.0/2.0*p[9]);
out[5300] = y[20]*y[4]*(p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[5315] = y[4]*(p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[5316] = y[20]*y[4]*(-p[8]*sin(y[21] - y[5]) + p[7]*cos(y[21] - y[5]));
out[5406] = y[18]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + 2*y[6]*p[10];
out[5407] = y[18]*y[6]*(-p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[5418] = y[6]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[5419] = y[18]*y[6]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7]));
out[5511] = y[18]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7])) + 2*y[6]*(-p[11] - 1.0/2.0*p[12]);
out[5512] = y[18]*y[6]*(p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[5523] = y[6]*(p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7]));
out[5524] = y[18]*y[6]*(-p[11]*sin(y[19] - y[7]) + p[10]*cos(y[19] - y[7]));
out[5610] = y[8]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9]));
out[5611] = y[0]*y[8]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[5618] = y[0]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9])) + 2*y[8]*(p[1] + p[13]) + y[10]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5619] = y[0]*y[8]*(-p[2]*cos(y[1] - y[9]) - p[1]*sin(y[1] - y[9])) + y[8]*y[10]*(-p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5620] = y[8]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5621] = y[8]*y[10]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5715] = y[8]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9]));
out[5716] = y[0]*y[8]*(-p[2]*sin(y[1] - y[9]) + p[1]*cos(y[1] - y[9]));
out[5723] = y[0]*(p[2]*cos(y[1] - y[9]) + p[1]*sin(y[1] - y[9])) + 2*y[8]*(-p[2] - p[14] - 1.0/2.0*p[3] - 1.0/2.0*p[15]) + y[10]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5724] = y[0]*y[8]*(p[2]*sin(y[1] - y[9]) - p[1]*cos(y[1] - y[9])) + y[8]*y[10]*(-p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5725] = y[8]*(p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11]));
out[5726] = y[8]*y[10]*(p[14]*sin(y[9] - y[11]) + p[13]*cos(y[9] - y[11]));
out[5822] = y[10]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11]));
out[5823] = y[2]*y[10]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[5828] = y[10]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11]));
out[5829] = y[8]*y[10]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5830] = y[2]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11])) + y[8]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11])) + 2*y[10]*(p[4] + p[13] + p[16]) + y[12]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5831] = y[2]*y[10]*(-p[5]*cos(y[3] - y[11]) - p[4]*sin(y[3] - y[11])) + y[8]*y[10]*(-p[14]*cos(y[9] - y[11]) - p[13]*sin(y[9] - y[11])) + y[10]*y[12]*(-p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[5832] = y[10]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5833] = y[10]*y[12]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5927] = y[10]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11]));
out[5928] = y[2]*y[10]*(-p[5]*sin(y[3] - y[11]) + p[4]*cos(y[3] - y[11]));
out[5933] = y[10]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11]));
out[5934] = y[8]*y[10]*(-p[14]*sin(y[9] - y[11]) + p[13]*cos(y[9] - y[11]));
out[5935] = y[2]*(p[5]*cos(y[3] - y[11]) + p[4]*sin(y[3] - y[11])) + y[8]*(p[14]*cos(y[9] - y[11]) + p[13]*sin(y[9] - y[11])) + 2*y[10]*(-p[5] - p[14] - p[17] - 1.0/2.0*p[6] - 1.0/2.0*p[15] - 1.0/2.0*p[18]) + y[12]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5936] = y[2]*y[10]*(p[5]*sin(y[3] - y[11]) - p[4]*cos(y[3] - y[11])) + y[8]*y[10]*(p[14]*sin(y[9] - y[11]) - p[13]*cos(y[9] - y[11])) + y[10]*y[12]*(-p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[5937] = y[10]*(p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13]));
out[5938] = y[10]*y[12]*(p[17]*sin(y[11] - y[13]) + p[16]*cos(y[11] - y[13]));
out[6040] = y[12]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13]));
out[6041] = y[10]*y[12]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[6042] = y[10]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13])) + 2*y[12]*(p[16] + 2*p[19]) + y[14]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6043] = y[10]*y[12]*(-p[17]*cos(y[11] - y[13]) - p[16]*sin(y[11] - y[13])) + y[12]*y[14]*(-2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6044] = y[12]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6045] = y[12]*y[14]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6145] = y[12]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13]));
out[6146] = y[10]*y[12]*(-p[17]*sin(y[11] - y[13]) + p[16]*cos(y[11] - y[13]));
out[6147] = y[10]*(p[17]*cos(y[11] - y[13]) + p[16]*sin(y[11] - y[13])) + 2*y[12]*(-p[17] - 2*p[20] - 1.0/2.0*p[18] - p[21]) + y[14]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6148] = y[10]*y[12]*(p[17]*sin(y[11] - y[13]) - p[16]*cos(y[11] - y[13])) + y[12]*y[14]*(-2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6149] = y[12]*(2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15]));
out[6150] = y[12]*y[14]*(2*p[20]*sin(y[13] - y[15]) + 2*p[19]*cos(y[13] - y[15]));
out[6252] = y[14]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15]));
out[6253] = y[12]*y[14]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6254] = y[12]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15])) + 2*y[14]*(2*p[19] + 2*p[22]) + y[16]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6255] = y[12]*y[14]*(-2*p[20]*cos(y[13] - y[15]) - 2*p[19]*sin(y[13] - y[15])) + y[14]*y[16]*(-2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6256] = y[14]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6257] = y[14]*y[16]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6357] = y[14]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15]));
out[6358] = y[12]*y[14]*(-2*p[20]*sin(y[13] - y[15]) + 2*p[19]*cos(y[13] - y[15]));
out[6359] = y[12]*(2*p[20]*cos(y[13] - y[15]) + 2*p[19]*sin(y[13] - y[15])) + 2*y[14]*(-2*p[20] - 2*p[23] - p[21] - p[24]) + y[16]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6360] = y[12]*y[14]*(2*p[20]*sin(y[13] - y[15]) - 2*p[19]*cos(y[13] - y[15])) + y[14]*y[16]*(-2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6361] = y[14]*(2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6362] = y[14]*y[16]*(2*p[23]*sin(y[15] - y[17]) + 2*p[22]*cos(y[15] - y[17]));
out[6464] = y[16]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6465] = y[14]*y[16]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6466] = y[18]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17])) + y[14]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17])) + 2*y[16]*(2*p[22] + p[25]);
out[6467] = y[18]*y[16]*(-p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17])) + y[14]*y[16]*(-2*p[23]*cos(y[15] - y[17]) - 2*p[22]*sin(y[15] - y[17]));
out[6468] = y[16]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6469] = y[18]*y[16]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6569] = y[16]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17]));
out[6570] = y[14]*y[16]*(-2*p[23]*sin(y[15] - y[17]) + 2*p[22]*cos(y[15] - y[17]));
out[6571] = y[18]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17])) + y[14]*(2*p[23]*cos(y[15] - y[17]) + 2*p[22]*sin(y[15] - y[17])) + 2*y[16]*(-2*p[23] - p[26] - p[24] - 1.0/2.0*p[27]);
out[6572] = y[18]*y[16]*(p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17])) + y[14]*y[16]*(2*p[23]*sin(y[15] - y[17]) - 2*p[22]*cos(y[15] - y[17]));
out[6573] = y[16]*(p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6574] = y[18]*y[16]*(-p[26]*sin(y[19] - y[17]) + p[25]*cos(y[19] - y[17]));
out[6666] = y[18]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7]));
out[6667] = y[18]*y[6]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[6676] = y[18]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6677] = y[18]*y[16]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6678] = 2*y[18]*(p[28] + p[10] + p[25]) + y[20]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[6]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + y[16]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6679] = y[18]*y[20]*(-p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21])) + y[18]*y[6]*(-p[11]*cos(y[19] - y[7]) + p[10]*sin(y[19] - y[7])) + y[18]*y[16]*(-p[26]*cos(y[19] - y[17]) + p[25]*sin(y[19] - y[17]));
out[6680] = y[18]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21]));
out[6681] = y[18]*y[20]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21]));
out[6771] = y[18]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7]));
out[6772] = y[18]*y[6]*(p[11]*sin(y[19] - y[7]) + p[10]*cos(y[19] - y[7]));
out[6781] = y[18]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6782] = y[18]*y[16]*(p[26]*sin(y[19] - y[17]) + p[25]*cos(y[19] - y[17]));
out[6783] = 2*y[18]*(-p[29] - p[11] - p[26] - 1.0/2.0*p[30] - 1.0/2.0*p[12] - 1.0/2.0*p[27]) + y[20]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21])) + y[6]*(p[11]*cos(y[19] - y[7]) - p[10]*sin(y[19] - y[7])) + y[16]*(p[26]*cos(y[19] - y[17]) - p[25]*sin(y[19] - y[17]));
out[6784] = y[18]*y[20]*(-p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[18]*y[6]*(-p[11]*sin(y[19] - y[7]) - p[10]*cos(y[19] - y[7])) + y[18]*y[16]*(-p[26]*sin(y[19] - y[17]) - p[25]*cos(y[19] - y[17]));
out[6785] = y[18]*(p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21]));
out[6786] = y[18]*y[20]*(p[29]*sin(y[19] - y[21]) + p[28]*cos(y[19] - y[21]));
out[6874] = y[20]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[6875] = y[20]*y[4]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6888] = y[20]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21]));
out[6889] = y[18]*y[20]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21]));
out[6890] = y[18]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + 2*y[20]*(p[28] + p[7]) + y[4]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[6891] = y[18]*y[20]*(-p[29]*cos(y[19] - y[21]) - p[28]*sin(y[19] - y[21])) + y[20]*y[4]*(-p[8]*cos(y[21] - y[5]) + p[7]*sin(y[21] - y[5]));
out[6979] = y[20]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6980] = y[20]*y[4]*(p[8]*sin(y[21] - y[5]) + p[7]*cos(y[21] - y[5]));
out[6993] = y[20]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21]));
out[6994] = y[18]*y[20]*(-p[29]*sin(y[19] - y[21]) + p[28]*cos(y[19] - y[21]));
out[6995] = y[18]*(p[29]*cos(y[19] - y[21]) + p[28]*sin(y[19] - y[21])) + 2*y[20]*(-p[29] - p[8] - 1.0/2.0*p[30] - 1.0/2.0*p[9]) + y[4]*(p[8]*cos(y[21] - y[5]) - p[7]*sin(y[21] - y[5]));
out[6996] = y[18]*y[20]*(p[29]*sin(y[19] - y[21]) - p[28]*cos(y[19] - y[21])) + y[20]*y[4]*(-p[8]*sin(y[21] - y[5]) - p[7]*cos(y[21] - y[5]));
out[7035] = -y[0]*sin(x[0] - y[1]);
out[7080] = cos(x[0] - y[1]);
out[7081] = y[0]*sin(x[0] - y[1]);
out[7140] = y[0]*cos(x[0] - y[1]);
out[7185] = sin(x[0] - y[1]);
out[7186] = -y[0]*cos(x[0] - y[1]);
out[7245] = y[0]*y[22]*cos(x[0] - y[1]) - y[0]*y[23]*sin(x[0] - y[1]);
out[7290] = y[22]*sin(x[0] - y[1]) + y[23]*cos(x[0] - y[1]);
out[7291] = -y[0]*y[22]*cos(x[0] - y[1]) + y[0]*y[23]*sin(x[0] - y[1]);
out[7312] = y[0]*sin(x[0] - y[1]);
out[7313] = y[0]*cos(x[0] - y[1]);
out[7350] = -y[0]*y[22]*sin(x[0] - y[1]) - y[0]*y[23]*cos(x[0] - y[1]);
out[7395] = y[22]*cos(x[0] - y[1]) - y[23]*sin(x[0] - y[1]);
out[7396] = y[0]*y[22]*sin(x[0] - y[1]) + y[0]*y[23]*cos(x[0] - y[1]);
out[7417] = y[0]*cos(x[0] - y[1]);
out[7418] = -y[0]*sin(x[0] - y[1]);
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7459] = 0;
}
else {
   out[7459] = -p[55];
}
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7460] = 0;
}
else {
   out[7460] = p[56];
}
if (p[58] &gt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5] || p[59] &lt; p[55]*(-x[4] + y[30] + u[22]) + p[56]*x[5]) {
   out[7530] = 0;
}
else {
   out[7530] = p[55];
}
if (p[71] &lt; -p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10]) || p[71] &lt; p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10])) {
   out[7885] = 0;
}
else {
   out[7885] = p[70]*(-p[68]/p[69] + 1);
}
if (p[71] &lt; -p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10]) || p[71] &lt; p[70]*(p[68]*(-x[10] + y[29])/p[69] + x[10])) {
   out[7949] = 0;
}
else {
   out[7949] = p[70]*p[68]/p[69];
}
out[7991] = -y[2]*sin(x[11] - y[3]);
out[8027] = cos(x[11] - y[3]);
out[8028] = y[2]*sin(x[11] - y[3]);
out[8096] = y[2]*cos(x[11] - y[3]);
out[8132] = sin(x[11] - y[3]);
out[8133] = -y[2]*cos(x[11] - y[3]);
out[8201] = y[2]*y[31]*cos(x[11] - y[3]) - y[2]*y[32]*sin(x[11] - y[3]);
out[8237] = y[31]*sin(x[11] - y[3]) + y[32]*cos(x[11] - y[3]);
out[8238] = -y[2]*y[31]*cos(x[11] - y[3]) + y[2]*y[32]*sin(x[11] - y[3]);
out[8266] = y[2]*sin(x[11] - y[3]);
out[8267] = y[2]*cos(x[11] - y[3]);
out[8306] = -y[2]*y[31]*sin(x[11] - y[3]) - y[2]*y[32]*cos(x[11] - y[3]);
out[8342] = y[31]*cos(x[11] - y[3]) - y[32]*sin(x[11] - y[3]);
out[8343] = y[2]*y[31]*sin(x[11] - y[3]) + y[2]*y[32]*cos(x[11] - y[3]);
out[8371] = y[2]*cos(x[11] - y[3]);
out[8372] = -y[2]*sin(x[11] - y[3]);
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8415] = 0;
}
else {
   out[8415] = -p[85];
}
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8416] = 0;
}
else {
   out[8416] = p[86];
}
if (p[88] &gt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16] || p[89] &lt; p[85]*(-x[15] + y[39] + u[26]) + p[86]*x[16]) {
   out[8484] = 0;
}
else {
   out[8484] = p[85];
}
if (p[101] &lt; -p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21]) || p[101] &lt; p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21])) {
   out[8841] = 0;
}
else {
   out[8841] = p[100]*(-p[98]/p[99] + 1);
}
if (p[101] &lt; -p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21]) || p[101] &lt; p[100]*(p[98]*(-x[21] + y[38])/p[99] + x[21])) {
   out[8903] = 0;
}
else {
   out[8903] = p[100]*p[98]/p[99];
}
out[8947] = -y[4]*sin(x[22] - y[5]);
out[8974] = cos(x[22] - y[5]);
out[8975] = y[4]*sin(x[22] - y[5]);
out[9052] = y[4]*cos(x[22] - y[5]);
out[9079] = sin(x[22] - y[5]);
out[9080] = -y[4]*cos(x[22] - y[5]);
out[9157] = y[4]*y[40]*cos(x[22] - y[5]) - y[4]*y[41]*sin(x[22] - y[5]);
out[9184] = y[40]*sin(x[22] - y[5]) + y[41]*cos(x[22] - y[5]);
out[9185] = -y[4]*y[40]*cos(x[22] - y[5]) + y[4]*y[41]*sin(x[22] - y[5]);
out[9220] = y[4]*sin(x[22] - y[5]);
out[9221] = y[4]*cos(x[22] - y[5]);
out[9262] = -y[4]*y[40]*sin(x[22] - y[5]) - y[4]*y[41]*cos(x[22] - y[5]);
out[9289] = y[40]*cos(x[22] - y[5]) - y[41]*sin(x[22] - y[5]);
out[9290] = y[4]*y[40]*sin(x[22] - y[5]) + y[4]*y[41]*cos(x[22] - y[5]);
out[9325] = y[4]*cos(x[22] - y[5]);
out[9326] = -y[4]*sin(x[22] - y[5]);
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9371] = 0;
}
else {
   out[9371] = -p[115];
}
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9372] = 0;
}
else {
   out[9372] = p[116];
}
if (p[118] &gt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27] || p[119] &lt; p[115]*(-x[26] + y[48] + u[30]) + p[116]*x[27]) {
   out[9438] = 0;
}
else {
   out[9438] = p[115];
}
if (p[131] &lt; -p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32]) || p[131] &lt; p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32])) {
   out[9797] = 0;
}
else {
   out[9797] = p[130]*(-p[128]/p[129] + 1);
}
if (p[131] &lt; -p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32]) || p[131] &lt; p[130]*(p[128]*(-x[32] + y[47])/p[129] + x[32])) {
   out[9857] = 0;
}
else {
   out[9857] = p[130]*p[128]/p[129];
}
out[9903] = -y[6]*sin(x[33] - y[7]);
out[9921] = cos(x[33] - y[7]);
out[9922] = y[6]*sin(x[33] - y[7]);
out[10008] = y[6]*cos(x[33] - y[7]);
out[10026] = sin(x[33] - y[7]);
out[10027] = -y[6]*cos(x[33] - y[7]);
out[10113] = y[6]*y[49]*cos(x[33] - y[7]) - y[6]*y[50]*sin(x[33] - y[7]);
out[10131] = y[49]*sin(x[33] - y[7]) + y[50]*cos(x[33] - y[7]);
out[10132] = -y[6]*y[49]*cos(x[33] - y[7]) + y[6]*y[50]*sin(x[33] - y[7]);
out[10174] = y[6]*sin(x[33] - y[7]);
out[10175] = y[6]*cos(x[33] - y[7]);
out[10218] = -y[6]*y[49]*sin(x[33] - y[7]) - y[6]*y[50]*cos(x[33] - y[7]);
out[10236] = y[49]*cos(x[33] - y[7]) - y[50]*sin(x[33] - y[7]);
out[10237] = y[6]*y[49]*sin(x[33] - y[7]) + y[6]*y[50]*cos(x[33] - y[7]);
out[10279] = y[6]*cos(x[33] - y[7]);
out[10280] = -y[6]*sin(x[33] - y[7]);
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10327] = 0;
}
else {
   out[10327] = -p[145];
}
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10328] = 0;
}
else {
   out[10328] = p[146];
}
if (p[148] &gt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38] || p[149] &lt; p[145]*(-x[37] + y[57] + u[34]) + p[146]*x[38]) {
   out[10392] = 0;
}
else {
   out[10392] = p[145];
}
if (p[161] &lt; -p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43]) || p[161] &lt; p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43])) {
   out[10753] = 0;
}
else {
   out[10753] = p[160]*(-p[158]/p[159] + 1);
}
if (p[161] &lt; -p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43]) || p[161] &lt; p[160]*(p[158]*(-x[43] + y[56])/p[159] + x[43])) {
   out[10811] = 0;
}
else {
   out[10811] = p[160]*p[158]/p[159];
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">matsym2c</span><span class="p">(</span><span class="n">fun_name</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">matrix_name</span><span class="p">,</span><span class="n">sparse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">xyupn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">inirun</span><span class="o">=</span><span class="s1">&#39;ini&#39;</span><span class="p">):</span>
    <span class="n">LHS</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">)</span>
    <span class="c1">#init_printing(use_unicode=True)</span>

    <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_xy</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_up</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="n">rhs_list</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="k">if</span> <span class="n">sparse</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">string_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">Assignment</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span><span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">irow</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">string_i</span> <span class="o">=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;x[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;y[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                    <span class="n">string_xy</span> <span class="o">+=</span> <span class="n">string_i</span> 
                <span class="k">elif</span> <span class="s1">&#39;p[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;u[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;Dt&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                    <span class="n">string_up</span> <span class="o">+=</span> <span class="n">string_i</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">string_num</span> <span class="o">+=</span> <span class="n">string_i</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">N_col</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_col</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">string_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">Assignment</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span><span class="n">matrix</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">irow</span><span class="o">*</span><span class="n">N_col</span><span class="o">+</span><span class="n">icol</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">string_i</span> <span class="o">=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">xyupn</span><span class="p">:</span>

                        <span class="k">if</span> <span class="s1">&#39;x[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;y[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                            <span class="n">string_xy</span> <span class="o">+=</span> <span class="n">string_i</span> 
                        <span class="k">elif</span> <span class="s1">&#39;p[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;u[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;Dt&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                            <span class="n">string_up</span> <span class="o">+=</span> <span class="n">string_i</span> 
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">string_num</span> <span class="o">+=</span> <span class="n">string_i</span> 
                            
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="n">string_i</span>
    

    <span class="n">defs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">xyupn</span><span class="p">:</span>
        <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_xy_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
        <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_up_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
        <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_num_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
        
    <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> 
    <span class="k">if</span> <span class="n">xyupn</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_xy_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span> <span class="o">+</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="n">string_xy</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_up_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span>  <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="n">string_up</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_num_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span>  <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="n">string_num</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span> <span class="o">+</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="n">string</span>
        <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>            
    
    <span class="k">return</span> <span class="n">defs</span><span class="p">,</span><span class="n">source</span>


<span class="c1">#print(string)</span>

<span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;f_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;f_run&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;g_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;g_run&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;h_run&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;jac_ini&#39;</span><span class="p">,</span><span class="n">jac_ini</span><span class="p">,</span><span class="s1">&#39;jac_ini&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;sp_jac_ini&#39;</span><span class="p">,</span><span class="n">sp_jac_ini_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;sp_jac_ini&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;jac_trap&#39;</span><span class="p">,</span><span class="n">jac_trap</span><span class="p">,</span><span class="s1">&#39;jac_trap&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;sp_jac_trap&#39;</span><span class="p">,</span><span class="n">sp_jac_trap_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;sp_jac_trap&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">),</span>
<span class="p">]</span>


<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">defs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">fun_name</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">matrix_name</span><span class="p">,</span><span class="n">sparse</span><span class="p">,</span><span class="n">xyupn</span><span class="p">,</span><span class="n">inirun</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
    <span class="n">defs_i</span><span class="p">,</span><span class="n">source_i</span> <span class="o">=</span> <span class="n">matsym2c</span><span class="p">(</span><span class="n">fun_name</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">matrix_name</span><span class="p">,</span><span class="n">sparse</span> <span class="o">=</span> <span class="n">sparse</span><span class="p">,</span> <span class="n">xyupn</span><span class="o">=</span><span class="n">xyupn</span><span class="p">,</span> <span class="n">inirun</span><span class="o">=</span><span class="n">inirun</span><span class="p">)</span>
    <span class="n">defs</span> <span class="o">+=</span> <span class="n">defs_i</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="n">source_i</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.392722606658936
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">sympy.codegen.ast</span> <span class="kn">import</span> <span class="n">Assignment</span>

<span class="k">def</span> <span class="nf">sym2xyup</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="n">inirun</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sys</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="se">\\</span><span class="s2">b&quot;</span>  <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;x[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sys</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;y_</span><span class="si">{</span><span class="n">inirun</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="se">\\</span><span class="s2">b&quot;</span>  <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;y[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sys</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;u_</span><span class="si">{</span><span class="n">inirun</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="se">\\</span><span class="s2">b&quot;</span>  <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;u[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">params_dict</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="se">\\</span><span class="s2">b&quot;</span>  <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;p[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        
    <span class="k">return</span> <span class="n">string</span>

<span class="k">def</span> <span class="nf">sym2str</span><span class="p">(</span><span class="n">fun_name</span><span class="p">,</span><span class="n">vector</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="n">inirun</span><span class="p">):</span>
    <span class="n">LHS</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">)</span>

    <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)):</span>
        <span class="n">string_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">Assignment</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span><span class="n">vector</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;out[</span><span class="si">{</span><span class="n">irow</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="n">inirun</span><span class="o">=</span><span class="n">inirun</span><span class="p">)</span>

    <span class="n">defs</span>   <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_eval(double *out,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
    <span class="n">source</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_eval(double *out,double *x,double *y,double *u,double *p,double Dt)&#39;</span>  <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="n">string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="n">defs</span><span class="p">,</span><span class="n">source</span>
        
        
                
<span class="k">def</span> <span class="nf">sym2rhs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indices</span><span class="p">,</span><span class="n">indptr</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="n">inirun</span><span class="p">):</span>
    <span class="n">LHS</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;LHS&#39;</span><span class="p">)</span>
    <span class="c1">#init_printing(use_unicode=True)</span>

    <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_xy</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_up</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="n">rhs_list</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indptr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="n">irow</span><span class="p">],</span><span class="n">indptr</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">icol</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">data_k</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">string_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">ccode</span><span class="p">(</span><span class="n">data_k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">string_i</span> <span class="o">=</span> <span class="n">sym2xyup</span><span class="p">(</span><span class="n">string_sym</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="n">inirun</span><span class="p">)</span>

                <span class="n">tipo</span> <span class="o">=</span> <span class="s1">&#39;num&#39;</span>
                <span class="k">if</span> <span class="s1">&#39;x[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;y[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                    <span class="n">tipo</span> <span class="o">=</span> <span class="s1">&#39;xy&#39;</span> 
                <span class="k">elif</span> <span class="s1">&#39;p[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;u[&#39;</span> <span class="ow">in</span> <span class="n">string_i</span> <span class="ow">or</span> <span class="s1">&#39;Dt&#39;</span> <span class="ow">in</span> <span class="n">string_i</span><span class="p">:</span>
                    <span class="n">tipo</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span> 
               
                <span class="n">rhs_list</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">string_i</span><span class="p">,</span><span class="n">tipo</span><span class="p">,</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">)]</span>
                
    <span class="k">return</span> <span class="n">rhs_list</span>

<span class="k">def</span> <span class="nf">rhs2str</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">,</span><span class="n">lhs_name</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;crs&#39;</span><span class="p">):</span>
    <span class="n">string_xy</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_up</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">string_num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">N_col</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>    
    <span class="k">for</span> <span class="n">data_i</span><span class="p">,</span><span class="n">tipo</span><span class="p">,</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;crs&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;dense&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">irow</span><span class="o">*</span><span class="n">N_col</span><span class="o">+</span><span class="n">icol</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;2d&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">irow</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">icol</span><span class="si">}</span><span class="s1">&#39;</span>
            
        <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
            <span class="n">string_xy</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lhs_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">] = </span><span class="si">{</span><span class="n">data_i</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">:</span>
            <span class="n">string_up</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lhs_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">] = </span><span class="si">{</span><span class="n">data_i</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span>
            <span class="n">string_num</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lhs_name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">] = </span><span class="si">{</span><span class="n">data_i</span><span class="si">}</span><span class="s1">&#39;</span>  
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
                
    <span class="k">return</span> <span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span>
        

<span class="k">def</span> <span class="nf">str2src</span><span class="p">(</span><span class="n">fun_name</span><span class="p">,</span><span class="n">matrix_xy</span><span class="p">,</span><span class="n">matrix_up</span><span class="p">,</span><span class="n">matrix_num</span><span class="p">,</span><span class="n">matrix_name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">):</span>
   

    <span class="n">defs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_xy_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
    <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_up_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
    <span class="n">defs</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_num_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
        
    <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> 
    <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_xy_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span> <span class="o">+</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="n">string_xy</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_up_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span>  <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="n">string_up</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;void </span><span class="si">{</span><span class="n">fun_name</span><span class="si">}</span><span class="s1">_num_eval(double *</span><span class="si">{</span><span class="n">matrix_name</span><span class="si">}</span><span class="s1">,double *x,double *y,double *u,double *p,double Dt)&#39;</span>  <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="n">string_num</span>
    <span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">defs</span><span class="p">,</span><span class="n">source</span>


<span class="c1">## de_jac_ini</span>
<span class="n">defs_f_ini</span><span class="p">,</span><span class="n">source_f_ini</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;f_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">)</span>
<span class="n">defs_g_ini</span><span class="p">,</span><span class="n">source_g_ini</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;g_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">105</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11025
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">defs_f_ini</span><span class="p">,</span><span class="n">source_f_ini</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;f_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">)</span>
<span class="n">defs_g_ini</span><span class="p">,</span><span class="n">source_g_ini</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;g_ini&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">)</span>

<span class="n">defs_f_run</span><span class="p">,</span><span class="n">source_f_run</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;f_run&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">)</span>
<span class="n">defs_g_run</span><span class="p">,</span><span class="n">source_g_run</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;g_run&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">)</span>

<span class="n">defs_h</span><span class="p">,</span><span class="n">source_h</span> <span class="o">=</span> <span class="n">sym2str</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">)</span>

<span class="n">sp_jac_ini_list</span> <span class="o">=</span> <span class="n">_doktocsr</span><span class="p">(</span><span class="n">SparseMatrix</span><span class="p">(</span><span class="n">jac_ini</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sp_jac_ini_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">sp_jac_ini_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">indptr</span> <span class="o">=</span> <span class="n">sp_jac_ini_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">sp_jac_ini_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1">#sym2rhs(data,indices,indptr,shape,sys,inirun)</span>
<span class="n">rhs_list</span> <span class="o">=</span> <span class="n">sym2rhs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indices</span><span class="p">,</span><span class="n">indptr</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">)</span>       
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>

<span class="n">defs_de_ini</span><span class="p">,</span><span class="n">source_de_ini</span> <span class="o">=</span> <span class="n">str2src</span><span class="p">(</span><span class="s1">&#39;de_jac_ini&#39;</span><span class="p">,</span><span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span><span class="p">,</span><span class="n">matrix_name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="c1">#rhs2str(rhs_list,lhs_name,shape,mode=&#39;crs&#39;)</span>
<span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span> <span class="o">=</span> <span class="n">rhs2str</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">,</span><span class="s1">&#39;out&#39;</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span>

<span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span> <span class="o">=</span> <span class="n">rhs2str</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">,</span><span class="s1">&#39;out&#39;</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;crs&#39;</span><span class="p">)</span>
<span class="n">defs_sp_ini</span><span class="p">,</span><span class="n">source_sp_ini</span> <span class="o">=</span> <span class="n">str2src</span><span class="p">(</span><span class="s1">&#39;sp_jac_ini&#39;</span><span class="p">,</span><span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span><span class="p">,</span><span class="n">matrix_name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>

<span class="n">defs</span> <span class="o">=</span> <span class="n">defs_de_ini</span> <span class="o">+</span> <span class="n">defs_sp_ini</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">source_de_ini</span> <span class="o">+</span> <span class="n">source_sp_ini</span>

<span class="n">sp_jac_trap_list</span> <span class="o">=</span> <span class="n">_doktocsr</span><span class="p">(</span><span class="n">SparseMatrix</span><span class="p">(</span><span class="n">jac_trap</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sp_jac_trap_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">sp_jac_trap_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">indptr</span> <span class="o">=</span> <span class="n">sp_jac_trap_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">rhs_list</span> <span class="o">=</span> <span class="n">sym2rhs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indices</span><span class="p">,</span><span class="n">indptr</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">sys</span><span class="p">,</span><span class="s1">&#39;run&#39;</span><span class="p">)</span>       
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>

<span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span> <span class="o">=</span> <span class="n">rhs2str</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">,</span><span class="s1">&#39;out&#39;</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span>
<span class="n">defs_de_run</span><span class="p">,</span><span class="n">source_de_run</span> <span class="o">=</span> <span class="n">str2src</span><span class="p">(</span><span class="s1">&#39;de_jac_trap&#39;</span><span class="p">,</span><span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span><span class="p">,</span><span class="n">matrix_name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>

<span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span> <span class="o">=</span> <span class="n">rhs2str</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">,</span><span class="s1">&#39;out&#39;</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;crs&#39;</span><span class="p">)</span>
<span class="n">defs_sp_run</span><span class="p">,</span><span class="n">source_sp_run</span> <span class="o">=</span> <span class="n">str2src</span><span class="p">(</span><span class="s1">&#39;sp_jac_trap&#39;</span><span class="p">,</span><span class="n">string_xy</span><span class="p">,</span><span class="n">string_up</span><span class="p">,</span><span class="n">string_num</span><span class="p">,</span><span class="n">matrix_name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>

<span class="n">defs</span> <span class="o">=</span> <span class="n">defs_f_ini</span> <span class="o">+</span> <span class="n">defs_g_ini</span> <span class="o">+</span> <span class="n">defs_f_run</span> <span class="o">+</span> <span class="n">defs_g_run</span> <span class="o">+</span> <span class="n">defs_h</span> <span class="o">+</span> <span class="n">defs_de_ini</span> <span class="o">+</span> <span class="n">defs_sp_ini</span> <span class="o">+</span> <span class="n">defs_de_run</span> <span class="o">+</span> <span class="n">defs_sp_run</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">source_f_ini</span> <span class="o">+</span> <span class="n">source_g_ini</span> <span class="o">+</span> <span class="n">source_f_run</span> <span class="o">+</span> <span class="n">source_h</span> <span class="o">+</span><span class="n">source_g_run</span><span class="o">+</span> <span class="n">source_de_ini</span> <span class="o">+</span> <span class="n">source_sp_ini</span> <span class="o">+</span> <span class="n">source_de_run</span> <span class="o">+</span> <span class="n">source_sp_run</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.708082437515259
4.149899005889893
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jac_ini</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(105, 105)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cffi</span>

<span class="n">ffi</span> <span class="o">=</span> <span class="n">cffi</span><span class="o">.</span><span class="n">FFI</span><span class="p">()</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">cdef</span><span class="p">(</span><span class="n">defs</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">set_source</span><span class="p">(</span><span class="n">module_name</span><span class="o">=</span><span class="s2">&quot;mod5&quot;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<span class="n">t_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.676298379898071
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">defs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>    
<span class="n">defs</span> <span class="o">+=</span> <span class="s1">&#39;void sp_jac_trap_xy_eval(double *out,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
<span class="n">defs</span> <span class="o">+=</span> <span class="s1">&#39;void sp_jac_trap_up_eval(double *out,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
<span class="n">defs</span> <span class="o">+=</span> <span class="s1">&#39;void sp_jac_trap_num_eval(double *out,double *x,double *y,double *u,double *p,double Dt);&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 

<span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>    
<span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;void sp_jac_trap_xy_eval(double *out,double *x,double *y,double *u,double *p,double Dt){&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span>
<span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;out[0][0] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">source</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ffi</span><span class="o">.</span><span class="n">cdef</span><span class="p">(</span><span class="n">defs</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">set_source</span><span class="p">(</span><span class="n">module_name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;C:\\Users\\jmmau\\workspace\\pydae\\examples\\grids\\grid_bpu\\k12p6\\test.cp38-win_amd64.pyd&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mod4</span> <span class="k">as</span> <span class="nn">jacs</span>

<span class="n">cffi_support</span><span class="o">.</span><span class="n">register_module</span><span class="p">(</span><span class="n">jacs</span><span class="p">)</span>
<span class="n">sp_jac_trap_xy_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_xy_eval</span>
<span class="n">sp_jac_trap_up_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_up_eval</span>
<span class="n">sp_jac_trap_num_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_num_eval</span>

<span class="nd">@nb</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="s2">&quot;float64[:](float64[:,:],float64[:],float64[:],float64[:],float64[:],float64)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">jac_trap_xy_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">):</span>   
        
    <span class="n">J_d_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">J_d</span><span class="p">))</span>
    <span class="n">x_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">y_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">u_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">p_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    
    <span class="n">sp_jac_trap_xy_eval_c</span><span class="p">(</span><span class="n">J_d_c_ptr</span><span class="p">,</span><span class="n">x_c_ptr</span><span class="p">,</span><span class="n">y_c_ptr</span><span class="p">,</span><span class="n">u_c_ptr</span><span class="p">,</span><span class="n">p_c_ptr</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J_d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_23132</span><span class="o">/</span><span class="mf">42112357.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">mod4</span> <span class="k">as</span> <span class="nn">jacs</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">cffi_support</span><span class="o">.</span><span class="n">register_module</span><span class="p">(</span><span class="n">jacs</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sp_jac_trap_xy_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_xy_eval</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">sp_jac_trap_up_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_up_eval</span>

<span class="ne">NameError</span>: name &#39;cffi_support&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">Dt</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">jac_trap_xy_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_24840</span><span class="o">/</span><span class="mf">643686114.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">Dt</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">jac_trap_xy_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;jac_trap_xy_eval&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cffi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ffi</span> <span class="o">=</span> <span class="n">cffi</span><span class="o">.</span><span class="n">FFI</span><span class="p">()</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">cdef</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    extern double dist(const double s[3][3], const double t[3][3]);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">lib</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">dlopen</span><span class="p">(</span><span class="s2">&quot;./dist.so&quot;</span><span class="p">)</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.63538</span><span class="p">,</span>  <span class="mf">0.379116</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16372</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.63538</span><span class="p">,</span> <span class="mf">0.378137</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16366</span> <span class="p">],[</span><span class="o">-</span><span class="mf">1.63193</span><span class="p">,</span> <span class="mf">0.379116</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16366</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.6467834</span><span class="p">,</span> <span class="mf">0.3749715</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1484985</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.6623441</span><span class="p">,</span> <span class="mf">0.37410975</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1647063</span> <span class="p">],[</span><span class="o">-</span><span class="mf">1.6602284</span><span class="p">,</span> <span class="mf">0.37400728</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1496595</span> <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Sp</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;double(*) [3]&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">Tp</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;double(*) [3]&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">dd</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">Sp</span><span class="p">,</span><span class="n">Tp</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_24840</span><span class="o">/</span><span class="mf">485113254.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">extern</span> <span class="n">double</span> <span class="n">dist</span><span class="p">(</span><span class="n">const</span> <span class="n">double</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">const</span> <span class="n">double</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]);</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="s2">&quot;&quot;&quot;)</span>
<span class="ne">----&gt; </span><span class="mi">8</span><span class="s2"> lib = ffi.dlopen(&quot;./dist.so&quot;)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span><span class="s2"> </span>
<span class="g g-Whitespace">     </span><span class="mi">10</span><span class="s2"> S = np.array([[-1.63538,  0.379116, -1.16372],[-1.63538, 0.378137, -1.16366 ],[-1.63193, 0.379116, -1.16366]], dtype=np.float32)</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">dlopen</span><span class="nt">(self, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span><span class="s2">                             &quot;or an already-opened &#39;void *&#39; handle&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span><span class="s2">         with self._lock:</span>
<span class="ne">--&gt; </span><span class="mi">150</span><span class="s2">             lib, function_cache = _make_ffi_library(self, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span><span class="s2">             self._function_caches.append(function_cache)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span><span class="s2">             self._libraries.append(lib)</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">_make_ffi_library</span><span class="nt">(ffi, libname, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">830</span><span class="s2"> def _make_ffi_library(ffi, libname, flags):</span>
<span class="g g-Whitespace">    </span><span class="mi">831</span><span class="s2">     backend = ffi._backend</span>
<span class="ne">--&gt; </span><span class="mi">832</span><span class="s2">     backendlib = _load_backend_lib(backend, libname, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">833</span><span class="s2">     #</span>
<span class="g g-Whitespace">    </span><span class="mi">834</span><span class="s2">     def accessor_function(name):</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">_load_backend_lib</span><span class="nt">(backend, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span><span class="s2">         if first_error is not None:</span>
<span class="g g-Whitespace">    </span><span class="mi">826</span><span class="s2">             msg = &quot;</span><span class="si">%s</span><span class="s2">.  Additionally, </span><span class="si">%s</span><span class="s2">&quot; % (first_error, msg)</span>
<span class="ne">--&gt; </span><span class="mi">827</span><span class="s2">         raise OSError(msg)</span>
<span class="g g-Whitespace">    </span><span class="mi">828</span><span class="s2">     return backend.load_library(path, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">829</span><span class="s2"> </span>

<span class="ne">OSError</span>: cannot load library &#39;./dist.so&#39;: error 0x7e.  Additionally, ctypes.util.find_library() did not manage to locate a library called &#39;./dist.so&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numba</span> <span class="k">as</span> <span class="nn">nb</span>
<span class="c1">#from numba import cffi_support</span>
<span class="kn">import</span> <span class="nn">numba.core.typing.cffi_utils</span> <span class="k">as</span> <span class="nn">cffi_support</span>
<span class="kn">import</span> <span class="nn">cffi</span>
<span class="n">ffi</span> <span class="o">=</span> <span class="n">cffi</span><span class="o">.</span><span class="n">FFI</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">mod4</span> <span class="k">as</span> <span class="nn">jacs</span>

<span class="n">cffi_support</span><span class="o">.</span><span class="n">register_module</span><span class="p">(</span><span class="n">jacs</span><span class="p">)</span>
<span class="n">sp_jac_trap_xy_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_xy_eval</span>
<span class="n">sp_jac_trap_up_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_up_eval</span>
<span class="n">sp_jac_trap_num_eval_c</span> <span class="o">=</span> <span class="n">jacs</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">sp_jac_trap_num_eval</span>

<span class="nd">@nb</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="s2">&quot;float64[:](float64[:],float64[:],float64[:],float64[:],float64[:],float64)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sp_jac_trap_xy_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">):</span>   
        
    <span class="n">J_d_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">J_d</span><span class="p">))</span>
    <span class="n">x_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">y_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">u_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">p_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    
    <span class="n">sp_jac_trap_xy_eval_c</span><span class="p">(</span><span class="n">J_d_c_ptr</span><span class="p">,</span><span class="n">x_c_ptr</span><span class="p">,</span><span class="n">y_c_ptr</span><span class="p">,</span><span class="n">u_c_ptr</span><span class="p">,</span><span class="n">p_c_ptr</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J_d</span>

<span class="nd">@nb</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="s2">&quot;float64[:](float64[:],float64[:],float64[:],float64[:],float64[:],float64)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sp_jac_trap_up_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">):</span>   
        
    <span class="n">J_d_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">J_d</span><span class="p">))</span>
    <span class="n">x_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">y_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">u_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">p_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    
    <span class="n">sp_jac_trap_up_eval_c</span><span class="p">(</span><span class="n">J_d_c_ptr</span><span class="p">,</span><span class="n">x_c_ptr</span><span class="p">,</span><span class="n">y_c_ptr</span><span class="p">,</span><span class="n">u_c_ptr</span><span class="p">,</span><span class="n">p_c_ptr</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J_d</span>

<span class="nd">@nb</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="s2">&quot;float64[:](float64[:],float64[:],float64[:],float64[:],float64[:],float64)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sp_jac_trap_num_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">):</span>   
        
    <span class="n">J_d_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">J_d</span><span class="p">))</span>
    <span class="n">x_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">y_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">u_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">p_c_ptr</span><span class="o">=</span><span class="n">ffi</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    
    <span class="n">sp_jac_trap_num_eval_c</span><span class="p">(</span><span class="n">J_d_c_ptr</span><span class="p">,</span><span class="n">x_c_ptr</span><span class="p">,</span><span class="n">y_c_ptr</span><span class="p">,</span><span class="n">u_c_ptr</span><span class="p">,</span><span class="n">p_c_ptr</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">J_d</span>


<span class="n">J_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">Dt</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">sp_jac_trap_xy_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
<span class="n">sp_jac_trap_up_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
<span class="n">sp_jac_trap_num_eval</span><span class="p">(</span><span class="n">J_d</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.01000000e+00, -1.00000000e-02,  1.00000000e-02,  5.00000000e-03,
        1.00500000e+00,  5.00000000e-03, -5.00000000e-03,  1.00000000e-02,
        1.50000000e-02, -5.00000000e-03, -5.00000000e-03,  1.01000000e+00,
       -0.00000000e+00, -1.00000000e-02,  1.01000000e+00, -0.00000000e+00,
        1.01000000e+00, -1.00000000e-02, -0.00000000e+00,  1.01000000e+00,
       -1.00000000e-02, -0.00000000e+00,  1.01000000e+00, -1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.00000001e+00,  1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.01000000e+00, -1.00000000e-02,
        1.01000000e+00, -1.00000000e-02,  1.00000000e-02,  5.00000000e-03,
        1.00500000e+00,  5.00000000e-03, -5.00000000e-03,  1.00000000e-02,
        1.50000000e-02, -5.00000000e-03, -5.00000000e-03,  1.01000000e+00,
       -0.00000000e+00, -1.00000000e-02,  1.01000000e+00, -0.00000000e+00,
        1.01000000e+00, -1.00000000e-02, -0.00000000e+00,  1.01000000e+00,
       -1.00000000e-02, -0.00000000e+00,  1.01000000e+00, -1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.00000001e+00,  1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.01000000e+00, -1.00000000e-02,
        1.01000000e+00, -1.00000000e-02,  1.00000000e-02,  5.00000000e-03,
        1.00500000e+00,  5.00000000e-03, -5.00000000e-03,  1.00000000e-02,
        1.50000000e-02, -5.00000000e-03, -5.00000000e-03,  1.01000000e+00,
       -0.00000000e+00, -1.00000000e-02,  1.01000000e+00, -0.00000000e+00,
        1.01000000e+00, -1.00000000e-02, -0.00000000e+00,  1.01000000e+00,
       -1.00000000e-02, -0.00000000e+00,  1.01000000e+00, -1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.00000001e+00,  1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.01000000e+00, -1.00000000e-02,
        1.01000000e+00, -1.00000000e-02,  1.00000000e-02,  5.00000000e-03,
        1.00500000e+00,  5.00000000e-03, -5.00000000e-03,  1.00000000e-02,
        1.50000000e-02, -5.00000000e-03, -5.00000000e-03,  1.01000000e+00,
       -0.00000000e+00, -1.00000000e-02,  1.01000000e+00, -0.00000000e+00,
        1.01000000e+00, -1.00000000e-02, -0.00000000e+00,  1.01000000e+00,
       -1.00000000e-02, -0.00000000e+00,  1.01000000e+00, -1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.00000001e+00,  1.00000000e-02,
       -1.00000000e-02,  1.01000000e+00,  1.01000000e+00, -1.00000000e-02,
        1.00000000e+00,  1.00000000e-02,  1.00000000e+00, -1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00, -1.00000000e+00, -2.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        1.00000000e+00, -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -2.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00, -1.00000000e+00, -2.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        1.00000000e+00, -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -2.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00, -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        2.00000000e+00, -2.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -4.00000000e+00, -2.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  3.00000000e+00, -3.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -6.00000000e+00, -3.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        3.00000000e+00, -3.00000000e+00, -2.00000000e+00,  2.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -6.00000000e+00, -3.00000000e+00,
        2.00000000e+00,  2.00000000e+00, -2.00000000e+00,  2.00000000e+00,
        4.00000000e+00, -4.00000000e+00, -2.00000000e+00,  2.00000000e+00,
        2.00000000e+00,  2.00000000e+00, -8.00000000e+00, -4.00000000e+00,
        2.00000000e+00,  2.00000000e+00, -2.00000000e+00,  2.00000000e+00,
        3.00000000e+00, -3.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        2.00000000e+00,  2.00000000e+00, -6.00000000e+00, -3.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  3.00000000e+00, -3.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -6.00000000e+00, -3.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  2.00000000e+00, -2.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
       -4.00000000e+00, -2.00000000e+00, -0.00000000e+00, -1.00000000e+00,
        1.00000000e+00,  0.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  0.00000000e+00, -1.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  0.00000000e+00,  1.00000000e+00, -1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
       -0.00000000e+00, -1.00000000e+00,  0.00000000e+00,  0.00000000e+00,
       -1.00000000e+00,  0.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  0.00000000e+00,
       -1.00000000e+00,  1.00000000e+00, -1.00000000e+00, -1.00000000e+00,
        0.00000000e+00,  1.00000000e+00, -1.00000000e+00, -0.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  0.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  0.00000000e+00,
       -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  0.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00, -0.00000000e+00, -1.00000000e+00,  0.00000000e+00,
        0.00000000e+00, -1.00000000e+00,  0.00000000e+00, -1.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        0.00000000e+00, -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
       -1.00000000e+00,  0.00000000e+00,  1.00000000e+00, -1.00000000e+00,
       -0.00000000e+00, -1.00000000e+00,  1.00000000e+00,  0.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        0.00000000e+00, -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  0.00000000e+00,
        1.00000000e+00, -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00, -0.00000000e+00, -1.00000000e+00,
        0.00000000e+00,  0.00000000e+00, -1.00000000e+00,  0.00000000e+00,
       -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  0.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -1.00000000e+00,  0.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -0.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        0.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  0.00000000e+00, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00,  1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        0.00000000e+00,  1.00000000e+00, -1.00000000e+00, -1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00, -0.00000000e+00,
       -1.00000000e+00,  0.00000000e+00,  0.00000000e+00, -1.00000000e+00,
        0.00000000e+00, -1.00000000e+00,  1.00000000e+00, -1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  0.00000000e+00, -1.00000000e+00,
        1.00000000e+00, -1.00000000e+00, -1.00000000e+00,  0.00000000e+00,
        1.00000000e+00, -1.00000000e+00,  2.50000000e-01,  2.50000000e-01,
        2.50000000e-01,  2.50000000e-01, -1.00000000e+00,  1.00000000e+00,
       -1.00000000e+00, -1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
        1.00000000e+00,  1.00000000e+00,  1.00000000e+00,  1.00000000e+00])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.printing.c</span> <span class="kn">import</span> <span class="n">C99CodePrinter</span>
<span class="n">printer</span> <span class="o">=</span> <span class="n">C99CodePrinter</span><span class="p">()</span>
<span class="c1">#print(printer.doprint(jac_trap))</span>
<span class="n">rhs_result</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">jac_trap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">jac_trap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#print(printer.doprint(jac_trap, assign_to=rhs_result))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rhs_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>out
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="n">void</span> <span class="nb">print</span><span class="p">(</span><span class="nb">int</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="nb">int</span> <span class="n">m</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">((</span><span class="n">arr</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="p">));</span>
<span class="p">}</span>
 
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">arr</span><span class="p">[][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">},</span> <span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">}};</span>
    <span class="nb">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
 
    <span class="o">//</span> <span class="n">We</span> <span class="n">can</span> <span class="n">also</span> <span class="n">use</span> <span class="s2">&quot;print(&amp;arr[0][0], m, n);&quot;</span>
    <span class="nb">print</span><span class="p">((</span><span class="nb">int</span> <span class="o">*</span><span class="p">)</span><span class="n">arr</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getIndex</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> 
  
    <span class="c1"># If input is invalid. </span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
  
    <span class="c1"># Create a deque to use it as a stack. </span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span> 
  
    <span class="c1"># Traverse through all elements </span>
    <span class="c1"># starting from i. </span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span> 
  
        <span class="c1"># Pop a starting bracket </span>
        <span class="c1"># for every closing bracket </span>
        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span> 
            <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span> 
  
        <span class="c1"># Push all starting brackets </span>
        <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span> 
            <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
  
        <span class="c1"># If deque becomes empty </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">k</span> 
  
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
  
<span class="k">def</span> <span class="nf">arg2np</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">function_name</span><span class="p">):</span>
    <span class="n">idx_end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">function_name</span> <span class="ow">in</span> <span class="n">string</span><span class="p">[</span><span class="n">idx_end</span><span class="p">:]:</span>
            <span class="c1">#print(string[idx_end:])</span>
            <span class="n">idx_ini</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s1">(&#39;</span><span class="p">,</span><span class="n">idx_end</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s1">(&#39;</span><span class="p">)</span>
            <span class="n">idx_end</span> <span class="o">=</span> <span class="n">getIndex</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">idx_ini</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">idx_ini</span><span class="p">:</span><span class="n">idx_end</span><span class="p">],</span><span class="sa">f</span><span class="s1">&#39;np.array([</span><span class="si">{</span><span class="n">string</span><span class="p">[</span><span class="n">idx_ini</span><span class="p">:</span><span class="n">idx_end</span><span class="p">]</span><span class="si">}</span><span class="s1">])&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">pass</span>
    <span class="k">return</span> <span class="n">string</span>   

<span class="k">def</span> <span class="nf">arg2cp</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">function_name</span><span class="p">,</span><span class="n">i_pwise</span><span class="p">):</span>
    <span class="n">idx_end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">function_name</span> <span class="ow">in</span> <span class="n">string</span><span class="p">[</span><span class="n">idx_end</span><span class="p">:]:</span>
            <span class="c1">#print(string[idx_end:])</span>
            <span class="n">idx_ini</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s1">(&#39;</span><span class="p">,</span><span class="n">idx_end</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s1">(&#39;</span><span class="p">)</span>
            <span class="n">idx_end</span> <span class="o">=</span> <span class="n">getIndex</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">idx_ini</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">string_inline</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">idx_ini</span><span class="p">:</span><span class="n">idx_end</span><span class="p">],</span><span class="s1">&#39;pwise[0]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s1">(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">string_pwise</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">idx_ini</span><span class="p">:</span><span class="n">idx_end</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">pass</span>
    <span class="k">return</span> <span class="n">string_pwise</span><span class="p">,</span><span class="n">string_inline</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cffi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ffi</span> <span class="o">=</span> <span class="n">cffi</span><span class="o">.</span><span class="n">FFI</span><span class="p">()</span>
<span class="n">ffi</span><span class="o">.</span><span class="n">cdef</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    extern double dist(const double s[3][3], const double t[3][3]);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">lib</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">dlopen</span><span class="p">(</span><span class="s2">&quot;./dist.so&quot;</span><span class="p">)</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.63538</span><span class="p">,</span>  <span class="mf">0.379116</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16372</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.63538</span><span class="p">,</span> <span class="mf">0.378137</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16366</span> <span class="p">],[</span><span class="o">-</span><span class="mf">1.63193</span><span class="p">,</span> <span class="mf">0.379116</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.16366</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.6467834</span><span class="p">,</span> <span class="mf">0.3749715</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1484985</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.6623441</span><span class="p">,</span> <span class="mf">0.37410975</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1647063</span> <span class="p">],[</span><span class="o">-</span><span class="mf">1.6602284</span><span class="p">,</span> <span class="mf">0.37400728</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1496595</span> <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Sp</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;double(*) [3]&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">Tp</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;double(*) [3]&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">dd</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">Sp</span><span class="p">,</span><span class="n">Tp</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_24840</span><span class="o">/</span><span class="mf">485113254.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">extern</span> <span class="n">double</span> <span class="n">dist</span><span class="p">(</span><span class="n">const</span> <span class="n">double</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">const</span> <span class="n">double</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]);</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="s2">&quot;&quot;&quot;)</span>
<span class="ne">----&gt; </span><span class="mi">8</span><span class="s2"> lib = ffi.dlopen(&quot;./dist.so&quot;)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span><span class="s2"> </span>
<span class="g g-Whitespace">     </span><span class="mi">10</span><span class="s2"> S = np.array([[-1.63538,  0.379116, -1.16372],[-1.63538, 0.378137, -1.16366 ],[-1.63193, 0.379116, -1.16366]], dtype=np.float32)</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">dlopen</span><span class="nt">(self, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span><span class="s2">                             &quot;or an already-opened &#39;void *&#39; handle&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span><span class="s2">         with self._lock:</span>
<span class="ne">--&gt; </span><span class="mi">150</span><span class="s2">             lib, function_cache = _make_ffi_library(self, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span><span class="s2">             self._function_caches.append(function_cache)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span><span class="s2">             self._libraries.append(lib)</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">_make_ffi_library</span><span class="nt">(ffi, libname, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">830</span><span class="s2"> def _make_ffi_library(ffi, libname, flags):</span>
<span class="g g-Whitespace">    </span><span class="mi">831</span><span class="s2">     backend = ffi._backend</span>
<span class="ne">--&gt; </span><span class="mi">832</span><span class="s2">     backendlib = _load_backend_lib(backend, libname, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">833</span><span class="s2">     #</span>
<span class="g g-Whitespace">    </span><span class="mi">834</span><span class="s2">     def accessor_function(name):</span>

<span class="nn">~\anaconda3\lib\site-packages\cffi\api.py</span> in <span class="ni">_load_backend_lib</span><span class="nt">(backend, name, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span><span class="s2">         if first_error is not None:</span>
<span class="g g-Whitespace">    </span><span class="mi">826</span><span class="s2">             msg = &quot;</span><span class="si">%s</span><span class="s2">.  Additionally, </span><span class="si">%s</span><span class="s2">&quot; % (first_error, msg)</span>
<span class="ne">--&gt; </span><span class="mi">827</span><span class="s2">         raise OSError(msg)</span>
<span class="g g-Whitespace">    </span><span class="mi">828</span><span class="s2">     return backend.load_library(path, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">829</span><span class="s2"> </span>

<span class="ne">OSError</span>: cannot load library &#39;./dist.so&#39;: error 0x7e.  Additionally, ctypes.util.find_library() did not manage to locate a library called &#39;./dist.so&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span> 

<span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">45</span><span class="o">-</span><span class="n">f35f4c05e32e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">string_pwise</span><span class="p">,</span><span class="n">string_inline</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">string_pwise</span>

<span class="ne">ValueError</span>: too many values to unpack (expected 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">string_pwise</span><span class="p">,</span><span class="n">string_inline</span> <span class="o">=</span>  <span class="n">arg2cp</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="s1">&#39;Piecewise&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">string_pwise_list</span> <span class="o">=</span> <span class="n">string_pwise</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">string_pwise_list</span>

<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string_pwise_list</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">string_pwise_list</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">string_pwise_list</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">it</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> 
    <span class="n">string_pwise_list</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">string_pwise_list</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    
    
<span class="n">string_pwise_list</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;-V_lim_4&#39;,
 &#39; V_lim_4 &lt; -K_stab_4*(T_1_4*(-x_lead_4 + z_wo_4)/T_2_4 + x_lead_4)&#39;,
 &#39;(V_lim_4&#39;,
 &#39; V_lim_4 &lt; K_stab_4*(T_1_4*(-x_lead_4 + z_wo_4)/T_2_4 + x_lead_4)&#39;,
 &#39;(K_stab_4*(T_1_4*(-x_lead_4 + z_wo_4)/T_2_4 + x_lead_4)&#39;,
 &#39; True&#39;]
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./examples\k12p6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Juan Manuel Mauricio<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>